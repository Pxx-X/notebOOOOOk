

# æ¦‚è¿°

## èƒŒæ™¯

- Implementing analog circuit layout is a heavily manual, timeconsuming, and error-prone task.   

- ![image-20251021185213217](assets/image-20251021185213217.png)
- analog  ICs flow faces challenges regarding low design efficiency and slow development speed [AIPlacer: 1] 
- ![image-20251022153431726](assets/image-20251022153431726.png)

### å’Œæ•°å­—åœ¨å¸ƒå±€çš„åŒºåˆ«

- Digital designers have to deal with a large number of rectangular devices, but all the devices share the same height and are placed in rows rather than freely, which resembles 1D Bin Packing Problem (Munienand Ezugwu, 2021). On the other hand, Analog and Mixed-Signal (AMS) ICs usually contain fewer devices, which may have different sizes and voltage levels and can be freely placed on the canvas. Hence, routability is generally not a critical issue for analog circuit layouts.
- Unlike digital ICs, analog ICs contain a large number of design constraints and intricate performance metrics to meet, which requires a steep learning curve for designers with a wealth of specialized skills. 
- ![image-20251022152231332](assets/image-20251022152231332.png)

#### performance-driven placement optimization  

AIPlacer:

- ![image-20251022093722788](assets/image-20251022093722788.png)
- ![image-20251022093631389](assets/image-20251022093631389.png)



## æŒ‡æ ‡

- area
- wirelength

  - HPWL
  - RWL
- symmetry
- parasitics
- power
- via
- thermal effects
- 

## éš¾ç‚¹

- the impact of layout on analog circuit performance can be very large due to significant RC (Resistance and Capacitance) parasitic generated in layout

  ![image-20251013094024375](assets/image-20251013094024375.png)

- the layout effect on performance is often very complex and thus difficult to be quickly and accurately estimated.

- analog circuit performance has much larger variety than digital circuits, and different performance metrics are used for different types of analog circuits. 

- Unlike its counterpart in the digital domain, AMS circuits are sensitive to layout parasitics and coupling while lacking a practical approach to model the performance from layouts [21]

- Unlike typical digital designs, AMS circuits are sensitive to small perturbation and distortion on the signal and raise more considerable challenges on the layouts.

- ä¼ä¸šæ–¹é¢ï¼šç”¨æˆ·ä¸ä¸€å®šæœ‰ GPU

- flow auto çš„ç¼ºç‚¹ï¼š

  1) Analog circuit topologies are rapidly evolving with new design practices. A fully automated flow is not flexible enough to satisfy the versatile customization demands. 

  2) Analog layout drawing is designer-specific. That is, two designers can have quite different ways to layout the same circuit according to their own experience and taste, which is hard to be implemented in a fully automated flow.

  3) Layouts generated by a fully automated flow may not align with designersâ€™ intuition, like the example in Figure 1, leading to performance degradation or difficulties in postsilicon debugging after tape-out. 

     ![image-20251015091642612](assets/image-20251015091642612.png)



## çº¦æŸç±»å‹

[DATE22]: symmetry [5], common-centroid [6], regularity [7], proximity [8], pre-placed [9], fixed-boundary [10], and mimimum/maximum separation [11]. Performance-related constraints such as monotonic current flows [12] have also been studied. 



### overlap  

### symmetry  

- ![image-20251014101346045](assets/image-20251014101346045.png)
- å¯¹ç§°æ€§çº¦æŸæ˜¯æ¨¡æ‹Ÿç‰ˆå›¾ç»¼åˆè¿‡ç¨‹ä¸­åº”ç”¨æœ€å¹¿æ³›ä¸”è‡³å…³é‡è¦çš„çº¦æŸä¹‹ä¸€ã€‚æ¨¡æ‹Ÿè®¾è®¡ç»å¸¸é‡‡ç”¨å·®åˆ†æ‹“æ‰‘ç»“æ„æ¥æŠ‘åˆ¶å…±æ¨¡å™ªå£°å¹¶å¢å¼ºç”µè·¯çš„é²æ£’æ€§ã€‚è¿™äº›æ‹“æ‰‘ç»“æ„ä¸­å™¨ä»¶çš„å¤±é…ä¼šæ˜¾è‘—é™ä½ç”µè·¯æ€§èƒ½ã€‚
- åœ¨ç‰ˆå›¾è®¾è®¡ä¸­ï¼Œéœ€è¦å¯¹è¿™äº›å™¨ä»¶è¿›è¡Œå¯¹ç§°çš„æ”¾ç½®å’Œå¸ƒçº¿ï¼Œä»¥ç¡®ä¿åŒ¹é…æ€§ã€‚
- Symmetry constraints are one of the most essential and widely adopted constraints applied during analog layout synthesis. Analog designs frequently use differential topologies to reject common-mode noise and enhance circuit robustness and performance [18]. Mismatch of sensitive devices in the layouts often cause performance degradation to offset and commonmode rejection ratio (CMRR) [19]. Thus correctly identifying symmetry constraints between sensitive devices are crucial for ensuring the quality of placement and routing
- Symmetry constraints are one of the ==most essential and widely adopted== constraints applied during analog layout synthesis
- ![image-20251022095602561](assets/image-20251022095602561.png)

#### hierarchical symmetry constraints  



### alignment  



### common-centroid  

- ![image-20251014101401573](assets/image-20251014101401573.png)
- [ICCAD20:19, 33, 38]  
- 

### topo

- ![image-20251014101411315](assets/image-20251014101411315.png)

### length

- ![image-20251014101421031](assets/image-20251014101421031.png)

### current/signal-flow

- [ICCAD20]
- Current flow constraint requires that the path or direction of current flows must align with the circuitâ€™s design. Adhering to current flow constraints mitigates issues such as voltage drops, noise, electromagnetic interference, and localized overheating.

### regularity  

- [ICCAD20: 7, 26, 39]  

### proximity  

- various minimum distances between devices
- [ICCAD20:6, 18, 25, 33â€“35, 41] 

### thermal effects  

- [ICCAD20:19, 20]   

### area





## ç‰ˆå›¾åŸºæœ¬çŸ¥è¯†

### MOS

![image-20251105111559354](assets/image-20251105111559354.png)

#### finger & multiple&fin

![image-20251105111457462](assets/image-20251105111457462.png)



<img src="assets/image-20251105111323938.png" alt="image-20251105111323938" style="zoom: 75%;" />

`finger`å°±æ˜¯åšæˆ==å‰æŒ‡==å½¢çŠ¶çš„å•ä¸ªæ™¶ä½“ç®¡ , `mulitiplier`æ˜¯å¤šä¸ªå¹¶åˆ—çš„æ™¶ä½“ç®¡

`finger`æ˜¯æŒ‡å°†ä¸€ä¸ªMOSç®¡çš„**æ²Ÿé“åˆ†å‰²**æˆå¤šä¸ª**å¹¶è”**çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ç§°ä¸ºä¸€ä¸ªfingerã€‚æ¯”å¦‚ï¼Œå¦‚æœä¸€ä¸ªMOSç®¡çš„å®½åº¦å¤ªå¤§ï¼Œç›´æ¥ç”»æˆä¸€ä¸ªå®½æ²Ÿé“å¯èƒ½ä¸ç¬¦åˆè®¾è®¡è§„åˆ™ï¼Œæˆ–è€…å¯¼è‡´ç‰ˆå›¾ä¸å‡åŒ€ã€‚è¿™æ—¶å€™ï¼ŒæŠŠå®ƒåˆ†æˆå¤šä¸ªfingerï¼Œæ¯ä¸ªfingerçš„å®½åº¦è¾ƒå°ï¼Œç„¶åå¹¶è”èµ·æ¥ï¼Œæ€»å®½åº¦å°±æ˜¯å„ä¸ªfingerçš„å®½åº¦ä¹‹å’Œã€‚MOSç®¡çš„æ¼ç«¯==ç»“ç”µå®¹å’Œæ …ç”µé˜»å‡ä¼šå‡å°==

<img src="assets/image-20251105111802933.png" alt="image-20251105111802933" style="zoom: 85%;" />

<img src="assets/image-20251105111714782.png" alt="image-20251105111714782" style="zoom:95%;" />

![image-20251105111945631](assets/image-20251105111945631.png)

`multiplier`æ˜¯æŒ‡å™¨ä»¶è¢«å¤åˆ¶çš„æ¬¡æ•°ã€‚æ¯”å¦‚ï¼Œè®¾ç½®multiplierä¸º4ï¼Œç›¸å½“äºæŠŠè¿™ä¸ªMOSç®¡**å¤åˆ¶**4ä¸ªï¼Œ==å¹¶è”==åœ¨ä¸€èµ·ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ==æ¯ä¸ªMOSç®¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒä»¬çš„æºã€æ¼ã€æ …éƒ½åˆ†åˆ«è¿æ¥åœ¨ä¸€èµ·==ã€‚è¿™æ ·==æ€»å®½åº¦æ˜¯å•ä¸ªMOSå®½åº¦çš„4å€==ï¼Œç”µæµèƒ½åŠ›ä¹Ÿå˜æˆå››å€ã€‚

> ä¸€èˆ¬æ¥è¯´ï¼Œfingersæ•°å–å¶æ•°ä¼šå¥½ä¸€äº›

`fin`

![image-20251105133445624](assets/image-20251105133445624.png)

### LDEæ•ˆåº”

layout-dependent effects

layout dependent effect can affect device `threshold voltage V_th` , `mobility` and circuit performance

 [(LDE) ](https://www.toutiao.com/article/7463532600296997412/?wid=1761215732491) [ç‰ˆå›¾åŸºç¡€çŸ¥è¯† - å°å°æ¡‚èŠ±ç³• - åšå®¢å›­](https://www.cnblogs.com/jinzbr/p/18235452)

<img src="assets/image-20251117183644094.png" alt="image-20251117183644094" style="zoom: 60%;" />

- LOD(Length of Diffusion)
  -  STI åº”åŠ›å¼•èµ·çš„ LOD æ•ˆåº”çš„å½±å“
  -  [å‘Šåˆ«å¤±é…ï¼å®ç”¨çš„ç‰ˆå›¾åŒ¹é…æŠ€å·§ â‘ ï¼ˆé™„ä»¿çœŸéªŒè¯è¯´æ˜ï¼‰ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/1966516064595715212)
  -  ä¸è¦ç›²ç›®å¥—ç”¨ â€œåŒ¹é…å°±æ˜¯ ABBAâ€ çš„ç»éªŒï¼ŒABBA èƒ½æŠµæ¶ˆå…¨å±€æ¢¯åº¦ï¼Œå´æ— æ³•æ¶ˆé™¤å±€éƒ¨ STI åº”åŠ›å·®å¼‚ã€‚
- WPE(Well Proximity Effect)
- OSE(OD Space Effect)
- PSE(Poly Space Effect)
- MBE(Metal Boundary Effectï¼‰
- PCE(Poly Cut Effect)

#### LOD

![image-20251118173042930](assets/image-20251118173042930.png)

<img src="assets/image-20251118173032364.png" alt="image-20251118173032364" style="zoom: 90%;" />

![image-20251204093624077](assets/image-20251204093624077.png)

![image-20251118173126341](assets/image-20251118173126341.png)



##### å®ä¾‹

[å‘Šåˆ«å¤±é…ï¼å®ç”¨çš„ç‰ˆå›¾åŒ¹é…æŠ€å·§ â‘ ï¼ˆé™„ä»¿çœŸéªŒè¯è¯´æ˜ï¼‰ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/1966516064595715212)

![image-20251117182541286](assets/image-20251117182541286.png)

![image-20251117183207081](assets/image-20251117183207081.png)

![image-20251117183219299](assets/image-20251117183219299.png)

![image-20251117183420324](assets/image-20251117183420324.png)

![image-20251118173059912](assets/image-20251118173059912.png)



#### WPE

![image-20251204093425205](assets/image-20251204093425205.png)

- ä¸ºäº†å‡å°‘é—©é”æ•ˆåº”ï¼ˆlatchupï¼‰ï¼Œåˆ¶é€ è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨é«˜èƒ½ç¦»å­æ³¨å…¥æ¥åˆ›å»ºæ·±å€’ç½®é˜±å‰–é¢ï¼ˆdeep retrograde well profileï¼‰ï¼Œæ”¹å˜äº†é˜±åŒºçš„æºæ‚å‰–é¢ï¼Œ

- åœ¨å…ˆè¿›æŠ€æœ¯èŠ‚ç‚¹ï¼ˆå¦‚çº³ç±³çº§CMOSï¼‰ï¼ŒLDEsä¼šå¯¼è‡´æ™¶ä½“ç®¡æ€§èƒ½å‚æ•°ï¼ˆå¦‚é˜ˆå€¼ç”µå‹ã€è¿ç§»ç‡ï¼‰å‘ç”Ÿå˜åŒ–

- å½±å“ï¼šæ”¹å˜`Vth` of a device based on its ==distance from the well edge==  

- The WPE induced mismatch can be ==minimized by keeping well edges far from devices== or by maintaining equal well spacing for the devices to be matched

  ![image-20251204092445982](assets/image-20251204092445982.png)

#### OSE

æ …æä¹‹é—´çš„é—´è·å˜åŒ–ä¼šå½±å“å¤šæ™¶ç¡…æ …å‘¨å›´åº”åŠ›ææ–™ï¼ˆå¦‚æ°®åŒ–ç¡…ï¼‰çš„ä½“ç§¯ï¼Œä»è€Œè°ƒåˆ¶åº”åŠ›å¹¶æ”¹å˜Vthã€‚

### variations 

å­¦æœ¯è§£é‡Šï¼š

--cite-->[Common-Centroid Layouts for Analog Circuits: Advantages and Limitations]()



<img src="assets/image-20251204142612730.png" alt="image-20251204142612730" style="zoom: 65%;" />

<img src="assets/image-20251204142631536.png" alt="image-20251204142631536" style="zoom: 65%;" />

<img src="assets/image-20251204142824797.png" alt="image-20251204142824797" style="zoom: 40%;" />

--cite-->[Constructive Place-and-Route for FinFET-Based Transistor Arrays in Analog Circuits Under Nonlinear Gradients]()

![image-20251205092053721](assets/image-20251205092053721.png)

![image-20251205092205334](assets/image-20251205092205334.png)





#### random variations 

Analog circuit performance can degrade due to random and spatial variations

can be mitigated using larger-sized devices  [2] [3] However, larger device may have more spatial variations as the distance between the devices increases [3].  --cit-->, Analog Transistor Placement Optimization Considering Nonlinear Spatial Variations

- ![image-20251204132825535](assets/image-20251204132825535.png)
- ![image-20251204132912065](assets/image-20251204132912065.png)

However, increasing the size may cause the devices to become more sensitive to process gradients  [2].

- ![image-20251204195318201](assets/image-20251204195318201.png)

random dopant fluctuations (RDF)





#### spatial variations

use common-centroid, which effectively reduces `linear variations` or `first-order effect`

Several factors, including `process variations`, `thermal distribution` or uneven `mechanical stress` from other circuit layers, can contribute to spatial variations

The spatial variations can be modeled by Taylor series, where the lower order terms have greater impacts on the mismatch among devices [3] [4] [5] [6]

- <img src="assets/image-20251204133228675.png" alt="image-20251204133228675" style="zoom: 70%;" />

However, for high performance systems, layout must be optimized considering `nonlinear or higher order effects` [3] [4] [5] [6] [10] [11]

- ![image-20251204133512055](assets/image-20251204133512055.png)
- Spatial variations have `linear` and `nonlinear` components
  - ![image-20251204154215459](assets/image-20251204154215459.png)
  - ![image-20251204154350909](assets/image-20251204154350909.png)
- ![image-20251205101928335](assets/image-20251205101928335.png)

#### Gradient-Based Variations  

![image-20251205102128219](assets/image-20251205102128219.png)



### ç”µè¿ç§»ï¼ˆEMï¼‰

ç”µè¿ç§»å¯ä»¥è¢«å½¢è±¡åœ°ç†è§£ä¸ºé‡‘å±å¯¼çº¿ä¸­çš„â€œåŠ¨è„‰ç¡¬åŒ–â€ã€‚å½“å¤§é‡ç”µå­ï¼ˆç”µæµï¼‰é•¿æ—¶é—´æŒç»­åœ°æµè¿‡ä¸€æ ¹ç»†å°çš„é‡‘å±å¯¼çº¿æ—¶ï¼Œä¼šåƒæ°´æµå†²å‡»æ²³åºŠä¸€æ ·ï¼Œå¯¹å¯¼çº¿åŸå­äº§ç”Ÿä¸€ä¸ªæŒç»­çš„æ¨åŠ›ï¼ˆç”µå­é£ï¼‰

å½±å“ï¼š

- **çŸ­æœŸ**ï¼šé‡‘å±åŸå­è¢«â€œå¹èµ°â€ï¼Œå¯¼è‡´å¯¼çº¿å±€éƒ¨å˜è–„ï¼Œç”µé˜»é€æ¸å¢å¤§ã€‚
- **é•¿æœŸ**ï¼šæœ€ç»ˆä¼šåœ¨é«˜ç”µæµå¯†åº¦å¤„å½¢æˆ**å¼€è·¯**ï¼ˆå¯¼çº¿æ–­è£‚ï¼‰ï¼Œç”µè·¯åŠŸèƒ½å®Œå…¨å¤±æ•ˆã€‚
- **å·¥è‰ºæ¼”è¿›ä¸‹çš„æ¶åŒ–**ï¼šåœ¨æ—§å·¥è‰ºä¸­ï¼Œè¿™ä¸ªé—®é¢˜ä¸»è¦å‘ç”Ÿåœ¨è¾ƒç²—çš„ä¸Šå±‚é‡‘å±ã€‚ä½†åœ¨çº³ç±³çº§å·¥è‰ºä¸­ï¼Œæœ€åº•å±‚çš„é‡‘å±å¯¼çº¿å˜å¾—æç»†ï¼Œç”µæµå¯†åº¦æ€¥å‰§å‡é«˜ï¼Œä½¿å¾—**ç”µè¿ç§»æˆä¸ºæ‰€æœ‰é‡‘å±å±‚éƒ½å¿…é¡»ä¸¥è‚ƒå¯¹å¾…çš„å¯é æ€§å¤´å·æ€æ‰‹**ï¼Œå°¤å…¶æ˜¯åœ¨å……æ»¡å¤§ç›´æµç”µæµçš„æ¨¡æ‹Ÿç”µè·¯å’Œç”µæºç½‘ç»œä¸­ã€‚

**å¯¹å…·ä½“ç”µè·¯çš„ç ´åæ€§å½±å“**ï¼š

- **ç”µæµé•œ**ï¼šè¿æ¥åŒ¹é…æ™¶ä½“ç®¡çš„é‡‘å±çº¿ä¸Šçš„å¯„ç”Ÿç”µé˜»ï¼Œä¼šå¯¼è‡´å®ƒä»¬çš„æºæç”µå‹å‡ºç°å¾®å°å·®å¼‚ã€‚è¿™ä¼šç›´æ¥ç ´åç²¾ç¡®çš„**ç”µæµæ¯”ä¾‹å…³ç³»**ï¼Œä½¿ç”µè·¯å¤±å»åŠŸèƒ½ã€‚
- **å·®åˆ†å¯¹/OTA**ï¼šå¯„ç”Ÿç”µé˜»ä¼šé™ä½ç”µè·¯çš„**è·¨å¯¼ï¼ˆGmï¼‰**ï¼Œè¿™æ˜¯æ¨¡æ‹Ÿç”µè·¯çš„æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ï¼Œç›´æ¥å¯¼è‡´æ”¾å¤§å™¨å¢ç›Šã€å¸¦å®½ç­‰å…³é”®æ€§èƒ½çš„åŠ£åŒ–ã€‚

can be reduced by identifying sensitive wires and using ==multiple parallel connections== between nodes,







### å‚è€ƒ

- [é›†æˆç”µè·¯ç‰ˆå›¾è®¾è®¡æŠ€æœ¯æ›´æ–°ç‰ˆ_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1dL411n7c2?spm_id_from=333.788.videopod.episodes&vd_source=ea5f077dc692dc32725d05ff92da61a5)
- [ç‰ˆå›¾çŸ¥è¯†å¤§æ€»ç»“_é™†æ™“æ¬¢.pdf](ç‰ˆå›¾çŸ¥è¯†å¤§æ€»ç»“_é™†æ™“æ¬¢.pdf)
- [Fingerå¯¹MOSç®¡çš„å½±å“ä»¥åŠfingerä¸Multipleçš„åŒºåˆ«ï¼ˆæµ…æ˜¾ç†è§£ï¼‰ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/690311740)
- [fingerså’Œmultiplier_invç”µè·¯ä¸­multiplierè·Ÿfingersçš„åŒºåˆ«-CSDNåšå®¢](https://blog.csdn.net/Cecilia_yxy/article/details/134325937)
- 





## ç‰ˆå›¾ç»˜åˆ¶æ–¹æ³•

### placement

![image-20251204154912770](assets/image-20251204154912770.png)

#### clustered

![image-20251204154922277](assets/image-20251204154922277.png)

#### Interdigitating 

- U may assume that interdigitization is a special case of a ==common centroid== but with ==only one row==

- ç›¸æ¯”cc,åœ¨==é¢ç§¯æ•ˆç‡å’Œå±€éƒ¨çƒ­ç®¡ç†==ä¸Šæ›´å¥½ï¼Œä½†å¯èƒ½å¼•å…¥é¢å¤–å¯„ç”Ÿç”µå®¹ã€‚

- Interdigitatedé€‚åˆ==é¢ç§¯å—é™æˆ–é«˜é¢‘åœºæ™¯==

- [In transistor matching if the total length of the mirror ==exceeds 80um or 100um==, try to use common centroid for better matching](https://www.edaboard.com/threads/common-centroid-interdigitization.58378/)

- virtuosoçš„æ“ä½œhttps://youtu.be/hy_APHz8XwQ?list=PL0oLvNvFrW9xbe26NgdX-HsknCJ4ioGT7

- åŸç†ï¼š

  ![image-20251126213635791](assets/image-20251126213635791.png)

  ![image-20251126213615569](assets/image-20251126213615569.png)

![image-20251124200855907](assets/image-20251124200855907.png)

![image-20251124182632825](assets/image-20251124182632825.png)

>[!WARNING]
>
>è²Œä¼¼fingerå¿…é¡»æ˜¯åŒæ•°ã€‚ä¸ºäº†æºæ¼å…±ç”¨ï¼Ÿ
>
>[in interdigitised pattern all the transistors are in interleaved pattern like suppose there are two transistors with 2 fingers each](https://www.edaboard.com/threads/common-centroid-interdigitization.58378/)



##### Interdigitation Patterns

![image-20251125085713644](assets/image-20251125085713644.png)



#### Common Centroid

- **Common Centroid** is more advanced matching technique, suitable for more complex analog structures, such as ==differential pairs==, BJT arrays in Bandgaps, R/C DAC array etc. 

- ç›¸æ¯”idgåœ¨é™ä½åç§»ç”µå‹å’Œæ”¹å–„çº¿æ€§åº¦æ–¹é¢æ›´ä¼˜ï¼Œä½†éœ€è¦æ›´å¤§é¢ç§¯å’Œæ›´å¤æ‚è·¯ç”±ã€‚

- Common-Centroidé€‚åˆé«˜ç²¾åº¦åº”ç”¨ï¼ˆå¦‚ä½åç§»è¦æ±‚ï¼‰

- â€œå…±è´¨å¿ƒå¸ƒå±€çš„ç¼ºç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚è¿™å°±éœ€è¦==äº¤å‰è¿æ¥å™¨ä»¶==ï¼Œå¢åŠ äº†åŒ¹é…å™¨ä»¶ä¹‹é—´çš„==åˆ†ç¦»==(areaâ¬†ï¸)ï¼Œå¹¶ä¸”åœ¨çº¿æ€§å·¥è‰ºæ¢¯åº¦ä¸æ˜¯ä¸»è¦é™åˆ¶çš„æƒ…å†µä¸‹å¯èƒ½ä¼šä½¿åŒ¹é…æ¶åŒ–ã€‚â€

- åœ¨åŒ¹é…vsåŒºåŸŸçš„æƒ…å†µä¸‹ï¼Œèµ¢å®¶è‚¯å®šæ˜¯åŒ¹é…ã€‚å› æ­¤ï¼Œå½“é‡‡ç”¨ccæ³•æ—¶ï¼Œé¢ç§¯æ˜¯æœ€ä¸é‡è¦çš„ã€‚å¦‚æœæ™¶ä½“ç®¡æ²¡æœ‰æ­£ç¡®åŒ¹é…ï¼Œé‚£ä¹ˆæ•´ä¸ªç”µè·¯å°±ä¼šè¢«æç ¸ã€‚æ‰€ä»¥ccæ˜¯ä¸€ä¸ªç¦éŸ³ã€‚ä¸å¯èƒ½æ€»æ˜¯ç”¨ccï¼Œä½†åªè¦æœ‰å¯èƒ½ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ç”¨å®ƒã€‚[Common Centroid & Interdigitization | Forum for Electronics](https://www.edaboard.com/threads/common-centroid-interdigitization.58378/)

- common centroid layout provides ==better matching== as in this method gradients are canceled in ==both X and Y direction==. Interdigitized method provides gradient cancellation in ==one direction only==.

- virtuosoçš„æ“ä½œhttps://youtu.be/mca7NKcTlhU?list=PL0oLvNvFrW9xbe26NgdX-HsknCJ4ioGT7

- Commoncentroid (CC) is a special layout technique which has been shown to be beneficial in reducing first-order variations [6] [7] [8] [9]

  - <img src="assets/image-20251204133356229.png" alt="image-20251204133356229" style="zoom: 70%;" />

- Common-centroid (CC) layouts are widely used in analog design to make circuits resilient to variations by matching device characteristics. However, CC layout may involve increased routing complexity and higher parasitics than other alternative layout schemes. 

- Commoncentroid (CC) layouts have been shown to be better than other alternatives such as clustered and interdigitated patterns for mitigating process-induced linear variations [3]  and are widely used to match circuit elements [2], [4], [5], [6], [7]. 

  <img src="assets/image-20251204195441794.png" alt="image-20251204195441794" style="zoom: 40%;" />

- square-like pattern offers the best matching performance [14] [11] --cite-->![image-20251204173246462](assets/image-20251204173246462.png)![image-20251204173254929](assets/image-20251204173254929.png)

  > å¹¶æ²¡æœ‰è¯´æ–¹å½¢ä¼šå¸¦æ¥æ›´å¥½çš„æ€§èƒ½

- One of the fundamental rules for CC layouts underscores the importance of achieving the maximum degree of dispersion [1]

  ![image-20251204212312726](assets/image-20251204212312726.png)

- It is important to note that CC layouts are generally not preferred for ==high-frequency== applications due to ==high parasitic effects==.

- å™¨ä»¶åŒ¹é…å¾—è¶Šå¥½ï¼Œè¿çº¿å¾€å¾€è¶Šå¤æ‚

- åŸç†ï¼š![image-20251126213434402](assets/image-20251126213434402.png)

- å­¦æœ¯è§£é‡Šfirst-order process gradient

  --cite-->[DATE21-Common-Centroid Layouts for Analog Circuits: Advantages and Limitations]()

  <img src="assets/image-20251204141357826.png" alt="image-20251204141357826" style="zoom: 40%;" /><img src="assets/image-20251204141414427.png" alt="image-20251204141414427" style="zoom: 40%;" />

  



![image-20251117192518533](assets/image-20251117192518533.png)



##### 2å™¨ä»¶ç¤ºä¾‹

![image-20251124201004547](assets/image-20251124201004547.png)

<img src="assets/image-20251126184220773.png" alt="image-20251126184220773" style="zoom: 65%;" />

![image-20251124183144139](assets/image-20251124183144139.png)

![image-20251125102253149](assets/image-20251125102253149.png)

![image-20251124205150034](assets/image-20251124205150034.png)

##### 3å™¨ä»¶ç¤ºä¾‹

![image-20251124190336284](assets/image-20251124190336284.png)

##### 4å™¨ä»¶ç¤ºä¾‹

![image-20251117194458082](assets/image-20251117194458082.png)







##### ccå’Œidgå¯ä»¥æ··åˆ

![image-20251124190743429](assets/image-20251124190743429.png)

> [!WARNING]
>
> æ„Ÿè§‰å…·ä½“é‚£ç§æ•ˆæœå¥½å¾ˆéš¾è¯´



##### ä¸ç›¸ç­‰/ä¸è§„åˆ™çš„æ•°é‡

![image-20251124190417956](assets/image-20251124190417956.png)

![image-20251124205453400](assets/image-20251124205453400.png)

![image-20251117204025955](assets/image-20251117204025955.png)



##### CC Patterns

![image-20251124183242920](assets/image-20251124183242920.png)

![image-20251125090012693](assets/image-20251125090012693.png)



#### ç”µé˜»ç”µå®¹æ ¹å™¨ä»¶æ³•(Root Device Method)

![image-20251118090048476](assets/image-20251118090048476.png)

![image-20251117192200155](assets/image-20251117192200155.png)

![image-20251124204301282](assets/image-20251124204301282.png)



![image-20251124194435852](assets/image-20251124194435852.png)

![image-20251124194606624](assets/image-20251124194606624.png)





#### Dummyè™šæ‹Ÿå™¨ä»¶

![image-20251117192358362](assets/image-20251117192358362.png)



#### è€ƒè™‘æºæ¼å…±ç”¨

A layout that does not share diffusion region can lead to worse routing length and may degrade spatial variations due to increased layout area.

Diffusion sharing is a widely used concept in analog applications [19] . Sharing diffusion region not only reduces layout area and routing cost but also minimizes spatial variation [21]. However, fully sharing diffusion region without using dummies is not always possible in a CC type layout  

minimizing only the dummy count leads to inferior results --cite-->[Multiobjective Optimization for Common-Centroid Placement of Analog Transistors]()



ä¸€ä¸ªå¾ˆå¥½çš„å›¾è¡¨ç¤ºï¼š

![image-20251204160000104](assets/image-20251204160000104.png)

![image-20251125100601461](assets/image-20251125100601461.png)

<img src="assets/image-20251125094654129.png" alt="image-20251125094654129" style="zoom: 55%;" />

<img src="assets/image-20251125100646967.png" alt="image-20251125100646967" style="zoom: 70%;" />

> må’Œnfç”¨æˆ·å®šä¸‹äº†ï¼Œæˆ‘ä»¬åº”è¯¥æ”¹ä¸äº†ã€‚è¿™ä¹Ÿçº¦æŸäº†ç®—æ³•çš„é€šç”¨æ€§ã€‚





#### å‚è€ƒ

- [æ¨¡æ‹Ÿç”µè·¯ç‰ˆå›¾è®¾è®¡ä¸­çš„åŒ¹é…è‰ºæœ¯](../Analog/æ¨¡æ‹Ÿç”µè·¯ç‰ˆå›¾è®¾è®¡ä¸­çš„åŒ¹é…è‰ºæœ¯.pdf)
- [Matching patterns - AnalogHub](https://analoghub.ie/category/Layout/article/layoutMatchingPatterns)
- [Matching Technique in Analog Layout - Siliconvlsi](https://siliconvlsi.com/matching-technique-in-analog-layout/)
- [CMOS Inverter Layout (Cadence Layout XL)](https://www.youtube.com/watch?v=KzH6KV-a6BA)
- [Matching Technique in Analog Layout - Siliconvlsi](https://siliconvlsi.com/matching-technique-in-analog-layout/)
- [Analog Layout Guide â€“ Nextra](https://neu-ucb-tvip.github.io/tvip-analog-workspace/Analog_Layout_Guide/#interdigitation-patterns)
- [people.engr.tamu.edu/spalermo/ecen474/Lab2.pdf](https://people.engr.tamu.edu/spalermo/ecen474/Lab2.pdf)
- ![image-20251126184530611](assets/image-20251126184530611.png)
- Thanks to hejing0901@primarius-tech.com



### routing

Route signals symmetrically to reduce IR drops and parasitic mismatches on either branch.

#### è¿‡å­”

çº³ç±³çº§æŠ€æœ¯ä¸­çš„é€šå­”ç”µé˜»åŒæ ·æ˜¾è‘—ï¼Œä¸”è¾ƒä½é‡‘å±å±‚å¯¹å•å‘å¸ƒçº¿çš„è¦æ±‚ä½¿å¾—CCå¸ƒå±€å¿…é¡»é‡‡ç”¨é€šå­”æ•°é‡è¾ƒå°‘çš„å¸ƒçº¿æ–¹æ¡ˆã€‚--cite-->[Performance-Aware Common-Centroid Placement and Routing of Transistor Arrays in Analog Circuits]

#### é«˜é¢‘ä¿¡å·çº¿

é«˜é¢‘ä¿¡å·çº¿èµ°çº¿é‡‡ç”¨é«˜å±‚é‡‘å±èµ°çº¿ï¼Œé«˜å±‚é‡‘å±åšåº¦å¤§ï¼Œå¯„ç”Ÿç”µé˜»å°ï¼Œå¯„ç”Ÿç”µå®¹ä¹Ÿå°ï¼›é«˜é¢‘ä¿¡å·çº¿å°½é‡èµ°ç›´çº¿ï¼›é¿å…å¹³è¡Œèµ°çº¿ï¼Œé‡‡ç”¨ä¸åŒå±‚é‡‘å±èµ°çº¿ï¼Œæˆ–è€…åŠ å¤§åŒå±‚é‡‘å±èµ°çº¿çš„é—´è·ä»¥å‡å°è€¦åˆå’Œä¸²æ‰°

All the critical signals should be shielded with gnd or clean reference signal

For high speed signals, the shield line shouldnâ€™t be put closer to the signal toavoid loading

#### å…³é”®ä¿¡å·

å…³é”®ä¿¡å·è¦ç¦»PADè¶³å¤Ÿè¿‘ï¼Œä»¥å‡å°èµ°çº¿å¯„ç”Ÿç”µå®¹ï¼Œç›´æµä¿¡å·çš„PADç”±äºè€ƒè™‘åˆ°æ¼å‹é™çš„é—®é¢˜ï¼Œèµ°çº¿è¶Šå®½ï¼Œæœ‰åˆ©äºå‡å°å‹é™ã€‚

Use proper spacing between two signal





#### ç”µè¿ç§»

![image-20251124195541622](assets/image-20251124195541622.png)

![image-20251124195548748](assets/image-20251124195548748.png)

#### Tiling?

![image-20251124195824854](assets/image-20251124195824854.png)

![image-20251124195845168](assets/image-20251124195845168.png)

#### Antenna Effect

![image-20251124195929141](assets/image-20251124195929141.png)

![image-20251124195938320](assets/image-20251124195938320.png)



#### Latchup 

![image-20251124195921855](assets/image-20251124195921855.png)

#### Power

![image-20251124200035088](assets/image-20251124200035088.png)

![image-20251124200047659](assets/image-20251124200047659.png)

![image-20251124200056495](assets/image-20251124200056495.png)

#### IR drop

IR drop **CANNOT BE IGNORED** in modern nodes, particularly when wide metal lines are not used for power/ground or high-current paths.

Always consider adding more metal width and multiple vias to keep IR drops minimal and symmetrical.

![image-20251124211531057](assets/image-20251124211531057.png)

![image-20251125091535340](assets/image-20251125091535340.png)

#### å‚è€ƒ

[eet.bme.hu/~bognar/rfic/Layout02.pdf](https://www.eet.bme.hu/~bognar/rfic/Layout02.pdf)

[ee.iitm.ac.in/vlsi/_media/courses/ee5325_2019/ee5325_lecture48_6nov2019.pdf](https://www.ee.iitm.ac.in/vlsi/_media/courses/ee5325_2019/ee5325_lecture48_6nov2019.pdf)



### å‡å°å¤±é…æ–¹æ³•æ€»ç»“

#### overview

- Place transistor segments in the areas of low-stress gradients.
- Place transistors in ==close proximity==. Keep the layout of the transistors as ==compact== as possible
- Orient transistors in the same direction.
- Whenever possible use ==Common centroid== layouts.
- Place transistors well away from the ==power== devices.
- For current matching keep the overdrive voltage large.
- For voltage, matching keeps overdrive voltage smaller.
- ![image-20251124192524946](assets/image-20251124192524946.png)

![image-20251124193716981](assets/image-20251124193716981.png)



#### å¢åŠ å°ºå¯¸

![image-20251230145315622](assets/image-20251230145315622.png)

![image-20251230145332911](assets/image-20251230145332911.png)

--cite-->[TCAD17](Layout Symmetries: Quantification and Application
to Cancel Nonlinear Process Gradients)

![image-20251117202516850](assets/image-20251117202516850.png)



#### è¿œç¦»å™ªå£°ï¼ˆç›¸åŒè·ç¦»ï¼‰

![image-20251124163922221](assets/image-20251124163922221.png)

#### dummy

![image-20251124163944401](assets/image-20251124163944401.png)

> [!CAUTION]
>
> ä¸è¿‡è²Œä¼¼æ­£å¸¸éƒ½åªæ˜¯åœ¨ä¸¤è¾¹æ”¾dummyï¼Œå¯èƒ½ä¸¥æ ¼çš„æ‰éœ€è¦ï¼Ÿ

> [!WARNING]
>
> å·¥è‰ºè¶Šå…ˆè¿›è¶Šè¦äºŒç»´çš„dummy



#### CCè€ƒè™‘äºŒé˜¶æ•ˆåº”

![image-20251230145830824](assets/image-20251230145830824.png)

--cite-->[TCAD17](Layout Symmetries: Quantification and Application
to Cancel Nonlinear Process Gradients)



### other

- ä¸ºäº†é˜²æ­¢**é—©é”æ•ˆåº”**ï¼Œç”µè·¯ç‰ˆå›¾è®¾è®¡çš„è§’åº¦ï¼ŒNMOSå’ŒPMOSé™„è¿‘è®¾ç½®å°½å¯èƒ½å¤šçš„æ¥è§¦å­”ä»¥å‡å°å¯„ç”Ÿç”µé˜»ï¼Œæˆ–è€…æ·»åŠ ä¿æŠ¤ç¯ï¼›

- è¦æ³¨æ„[å¤©çº¿æ•ˆåº”](https://zhida.zhihu.com/search?content_id=220772738&content_type=Article&match_order=1&q=å¤©çº¿æ•ˆåº”&zhida_source=entity)å’Œ[ç”µè¿ç§»](https://zhida.zhihu.com/search?content_id=220772738&content_type=Article&match_order=1&q=ç”µè¿ç§»&zhida_source=entity)ï¼Œé•¿çš„é‡‘å±è¦ä¸æ–­è¿›è¡Œè·³çº¿æ¥å‡å¼±å¤©çº¿æ•ˆåº”ï¼Œåœ¨å¤§ç”µæµçš„èµ°çº¿ä¸Šï¼Œé‡‘å±çº¿å®½è¦è¶³å¤Ÿå¤§ï¼Œå¦‚æœä¸å¤Ÿå¯ä»¥é‡‡ç”¨å¤šå±‚é‡‘å±åˆ†æµã€‚

- åœ¨æ¨¡æ‹Ÿæ¨¡å—å’Œæ•°å­—æ¨¡å—ä¹‹é—´è¦åŠ éš”ç¦»ç¯ä»¥éš”ç¦»å™ªå£°å¹²æ‰°ã€‚

- æ— è®ºæ€ä¹ˆåŠªåŠ›æ”¹è¿›å¤±é…ï¼ŒBipolarå·¥è‰ºæ¯”CMOSå·¥è‰ºçš„åŒ¹é…æ€§æ›´å¥½ï¼ŒåŸå› å¦‚ä¸‹ï¼š

  ï¼ˆ1ï¼‰Bipolarå¤±è°ƒè¡¨è¾¾å¼ä¸­ä¸åŒ…å«é˜ˆå€¼ç”µå‹Vtçš„ç¦»æ•£å½±å“ï¼›

  ï¼ˆ2ï¼‰Bipolarçš„æ¯”ä¾‹å› å­ä¸ºkT/qï¼Œå°äºCMOSå™¨ä»¶çš„Vov/2ï¼›

  ï¼ˆ3ï¼‰Bipolarå¤±è°ƒç”µå‹éšæ¸©åº¦çš„æ¼‚ç§»å¾ˆå®¹æ˜“æ§åˆ¶ï¼Œå‡å°Vosçš„åŒæ—¶ä¹Ÿä¼šå‡å°å¤±è°ƒç”µå‹çš„æ¸©æ¼‚ï¼›
  
- 



### å‚è€ƒ

[Analog Layout Guide â€“ Nextra](https://neu-ucb-tvip.github.io/tvip-analog-workspace/Analog_Layout_Guide/)





## å¸¸è§patternç‰ˆå›¾

### overview

the **Interdigitation** is a ==less complex== method, and it would be sufficient for structures like small ==current mirrors== and ==biasing circuits==. Using this pattern will be **more area-efficient** and allows **simple routing**.

When we are talking about structures that require **maximum precision** - such as R/C DAC arrays, differential pairs - we have to use the **Common Centroid** to achieve the best performance. 

![image-20251124170401087](assets/image-20251124170401087.png)

![image-20251125090815543](assets/image-20251125090815543.png)

> ä¹Ÿä¸ä¸€å®šï¼Œæˆ‘çœ‹ä¹Ÿæœ‰æŒºå¤šç”µæµé•œç”¨CCçš„

<img src="assets/image-20251204154957700.png" alt="image-20251204154957700" style="zoom: 90%;" />

-- cite-->[DATE21-Common-Centroid Layouts for Analog Circuits: Advantages and Limitations]()

![image-20251204154754125](assets/image-20251204154754125.png)

-- cite-->[DATE24 Analog Transistor Placement Optimization Considering Nonlinear Spatial Variations]()

### ç”µæµé•œ

#### åŸºæœ¬ç”µæµé•œ

<img src="assets/image-20251117194841219.png" alt="image-20251117194841219" style="zoom: 35%;" />

![image-20251124150322926](assets/image-20251124150322926.png)

#### cascodeç”µæµé•œ

æºæ¼å…±ç”¨

![image-20251124192136470](assets/image-20251124192136470.png)

#### å…±æºå…±æ …ç”µæµé•œ

[IC Layoutç‰ˆå›¾å®æ“é‡è¦çŸ¥è¯†-ç”µæµé•œ_ç”µæµé•œç‰ˆå›¾åŒ¹é…è®¾è®¡-CSDNåšå®¢](https://blog.csdn.net/qq_49315469/article/details/129650954)

![image-20251124141230390](assets/image-20251124141230390.png)

ä¸¤ç§åŒ¹é…æ–¹å¼ï¼Œä¸€ç§æ˜¯B A A Bï¼Œå°†å™¨ä»¶æ‘†æ”¾æˆä¸€æ’ç„¶åä¸¤è¾¹åŠ dummyï¼Œæœ€åå†å›´ä¸ŠPç¯

![image-20251124141208614](assets/image-20251124141208614.png)

å¦å¤–ä¸€ç§åŒ¹é…æ–¹å¼æ˜¯æ‘†æ”¾æˆä¸¤æ’ï¼Œäº¤å‰åŒ¹é…ï¼Œå³ç¬¬ä¸€æ’ä¸ºdummy A B dummyï¼Œç¬¬äºŒæ’ä¸ºdummy B A dummyï¼Œç„¶åå†å›´ä¸ŠPç¯

![image-20251124141217239](assets/image-20251124141217239.png)



#### å¤šè·¯è¾“å‡ºç”µæµé•œ

![image-20251124170007459](assets/image-20251124170007459.png)

![image-20251124170045229](assets/image-20251124170045229.png)

![image-20251124170057535](assets/image-20251124170057535.png)

https://www.youtube.com/watch?list=PL0oLvNvFrW9xbe26NgdX-HsknCJ4ioGT7&v=mca7NKcTlhU&embeds_referring_euri=https%3A%2F%2Fanaloghub.ie%2F&source_ve_path=MjM4NTE



![image-20251124205525800](assets/image-20251124205525800.png)

> [!WARNING]
>
> ç›¸æ¯”idgï¼Œccæ•°é‡ç¿»å€äº†ï¼Ÿä¸ºäº†å…¨éƒ¨æºæ¼å…±ç”¨ï¼Œidgåªèƒ½è¿™ä¹ˆè®¾è®¡ï¼æ³¨æ„æ¯ä¸€ä¸ªB-Bæˆ–è€…C-Cä¹‹é—´éƒ½æ˜¯Dç«¯çš„ï¼Œä¸¤è¾¹çš„éƒ½æ˜¯å…±ç”¨çš„GND

![image-20251125093612920](assets/image-20251125093612920.png)

![image-20251125093701814](assets/image-20251125093701814.png)

>[!WARNING]
>
>M7é£å“ªå»äº†ï¼Ÿ



### å·®åˆ†å¯¹

- [ç‰ˆå›¾åŒ¹é…ä¹‹å·®åˆ†ç”µæµé•œ_ç”µæµé•œç‰ˆå›¾åŒ¹é…è®¾è®¡-CSDNåšå®¢](https://blog.csdn.net/weixin_52567455/article/details/129659950)
  
  - å·®åˆ†å¯¹å¿…é¡»é‡‡ç”¨åŒæ’çš„==å…±è´¨å¿ƒABBA==å½¢å¼ã€‚é™¤éåœ¨ä¸é‡è¦çš„cellï¼Œå¾—åˆ°ç”µè·¯å‡†è®¸æ‰å¯ç”»ä¸€æ’ã€‚==å¿…é¡»åŠ dummy==(ä¸€æ’ï¼Œä¸¤æ’)
  
    > ï¼ä¸€å®šæ˜¯ä¸€å¯¹çš„å—
  
  - åœ¨m<4çš„æƒ…å†µä¸‹ï¼Œs/Dç«¯ä¸åˆå¹¶çš„ç”»æ³•åŒ¹é…åº¦æ¯”æºæ¼åˆå¹¶çš„é«˜ä¸€äº›ã€‚å…·ä½“çœ‹é•¿åº¦å·®è·åˆ†æï¼Œè¶…è¿‡4ä¸ªä¸å»ºè®®ç”¨sã€Dä¸åˆå¹¶æ–¹æ³•
  
  - å·®åˆ†å¯¹çš„åŒ¹é…éœ€åŠ dummy
  
  - å·®åˆ†å¯¹ä¸€èˆ¬é‡‡ç”¨ABBAã€äºŒç»´çš„åŒ¹é…æ–¹å¼ï¼Œè¾ƒä¹‹AABBå¼çš„åŒ¹é…å…·æœ‰ä¸­å¿ƒå¯¹ç§°ï¼Œèƒ½å¤Ÿå‡å°å¤±é…ï¼Œæ›´ä½³æ€§èƒ½çš„ä¼˜ç‚¹ï¼Œå·®åˆ†å¯¹ä¸­çš„ABBAåŒ¹é…å½¢å¼ä¸”mergeçš„æƒ…å†µéœ€è¦ä¿è¯å·¦å³ï¼Œä¸Šä¸‹éƒ½å…·å¤‡è¿™ç§å½¢å¼ï¼Œä¸”åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šç®¡å­æ•°é‡ä¸º4X(X > 1æ—¶),Aå¯ä»¥ç­‰äºaaï¼ŒB=bb
  
    ![mergeçš„å·®åˆ†å¯¹](https://i-blog.csdnimg.cn/blog_migrate/4c8fc0d00fa57f347e83805cecabf9b5.png#pic_center)
  
  - å·®åˆ†å¯¹çš„gateè¿çº¿éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œéäº¤å‰ä½ç½®ç›¸é‚»gateé—´çš„è¿çº¿ä¸è¦å‡ºç°å¤šå±‚é‡‘å±å å±‚è¿é€šçš„æƒ…å†µï¼Œä¸”æœ€å¥½ç”¨m2è¿æ¥ï¼Œæ‰€æœ‰gateä¸Šé¢çš„é‡‘å±å­”è¦ä¸€è‡´
  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](assets/da32a7feaa6221f765d98798081c983b.png)
  
  - å·®åˆ†çš„gateä¸æºæ¼çš„çº¿åˆ†åˆ«å‡ºåœ¨ä¸¤è¾¹ï¼Œgateå¿…é¡»åŠ å±è”½çº¿
  
  - å·®åˆ†å¯¹ä¸Šé¢ä¸å…è®¸è·¨å…¶ä»–çº¿ï¼Œè‡ªèº«æºæ¼çº¿ä¹Ÿå°½é‡ä¸è¦è·¨ï¼Œæœ‰çº¿é“çš„æƒ…å†µä¸‹è¦ç•™å‡ºæºæ¼çº¿çš„èµ°çº¿ä½ç½®ï¼Œä¸”æœ€å¥½æœ‰å±è”½ï¼ŒåŠ å±è”½æ—¶å¤´çš„åœ°æ–¹è¦æ¯å±‚é‡‘å±éƒ½åŒ…ä½
  
  ![image-20251125093518249](assets/image-20251125093518249.png)
  
  ![image-20251125093505161](assets/image-20251125093505161.png)
  
- ![image-20251124145659358](assets/image-20251124145659358.png)

[ã€Analog Layout Considerationsã€‘å¸ƒå±€ä¸­çš„åŒ¹é…ä¸å¯¹ç§°æ€§æŠ€æœ¯_Importance of Symmetry in Analog Layout - CSDNæ–‡åº“](https://wenku.csdn.net/column/658wg015qj)

[ç”µè·¯è®¾è®¡ï¼šå·®åˆ†å¯¹åŸç†ä¸ç‰ˆå›¾ç»˜åˆ¶å…³é”®-CSDNåšå®¢](https://blog.csdn.net/weixin_44606092/article/details/134468049)



### cap

![image-20251125091444620](assets/image-20251125091444620.png)





### å…¶ä»–

![image-20251125101746517](assets/image-20251125101746517.png)

![image-20251125101804692](assets/image-20251125101804692.png)





# placement ç®—æ³•

## ä¸‰ç§å¸ƒå±€èŒƒå¼

- ç»“åˆæ•°å­— APR ç»¼åˆçš„

  - ä»ç„¶ç¼ºä¹æ™®éé€‚ç”¨æ€§  

- Procedural

  - ç¨‹åºæ€§å¸ƒå±€ç”Ÿæˆå™¨åœ¨å¼€å‘å‚æ•°åŒ–å•å…ƒä»¥åŠæ•´åˆç”¨äºç¼–ç å™¨ä»¶æ”¾ç½®å’Œå¸ƒçº¿çš„è„šæœ¬æ–¹é¢ä»ç„¶éœ€è¦å¤§é‡çš„äººå·¥åŠ³åŠ¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™äº›æ–¹æ³•åœ¨å°†è®¾è®¡è¿ç§»åˆ°ä¸åŒæŠ€æœ¯èŠ‚ç‚¹æ—¶å·²æ˜¾è‘—å‡å°‘äº†äººå·¥å·¥ä½œé‡ã€‚

- åŸºäºä¼˜åŒ–çš„

  - åŸºäºä¼˜åŒ–çš„å¸ƒå±€ç»¼åˆçš„å…¸å‹æµç¨‹å°†å¸ƒå±€è€ƒè™‘å› ç´ è¡¨è¿°ä¸ºç”¨æˆ·å®šä¹‰çš„å‚æ•°æˆ–çº¦æŸ



## GA

KubalÃ­k et al. (2019) and KubalÃ­k et al. (2023)   FLP   



## Simulated Annealing

Historically, most analog placement methods were based on simulated annealing and focused on handling geometrical constraints such as symmetry that are specific to analog ICs [DATE22[4]â€“[8]]()

### ä¼˜ç‚¹

- flexibility in incorporating different types of cost functions  

### ç¼ºç‚¹

- not a fast algorithm in general
  - its runtime speed is acceptable for analog IC designs, which typically have much less elements than digital circuits. 
- the approach cannot guarantee good performance for large-scale analog netlists  
- cannot utilize past or external knowledge to enhance exploration of the solution space, as each problem instance is optimized anew.

### ç›¸å…³è®ºæ–‡

- ![image-20251022093326904](assets/image-20251022093326904.png)

- ![image-20251013095453449](assets/image-20251013095453449.png)

- ![image-20251013100925187](assets/image-20251013100925187.png)

- Cohn, J., Garrod, D., et al. (1991). KOAN/ANAGRAM II: new tools for device-level analog placement and routing. IEEE Journal of Solid-State Circuits, 26(3): 330â€“342

- Martins, R., LourencÂ¸o, N., and Horta, N. (2015). Multiobjective optimization of analog integrated circuit placement hierarchy in absolute coordinates. 

  Expert Systems with Applications, 42(23): 9137â€“9151.
  
- 

  



## LP

Analytical Approaches  

### NLP

non-linear programming (NLP)  

absolute representation, where each element is described by its actual coordinates. While this approach makes it ==easy to describe the majority of the constraints==, it can produce ==infeasible solutions== due to the overlapping of design elements. which initially determine the ==global placement== using `Nonlinear Programming` and then produce feasible placement using `Linear Programming (LP)` or other methods. (ç±»ä¼¼ SA)

For conventional performanceoblivious analog placement, analytical techniques are ==55Ã—== faster than `simulated annealing`. However, not all analytical techniques can reduce area and wirelength compared to simulated annealing. 

cannot utilize past or external knowledge to enhance exploration of the solution space, as each problem instance is optimized anew.

- [ICCAD20: 29, 40]  

  ![image-20251014155910435](assets/image-20251014155910435.png)

- in theory has advantages in scalability. However, NLP needs to relax the constraints and therefore requires extra post-processing step to legalize the results.

- the constraint relaxation and the ==extra legalization step== restrict its potential to handle various constraints simultaneously. 

- Xu et al. (2017)  

- (Mirhoseini et al., 2021)   

- Chen, T.-C., Jiang, Z.-W., et al. (2008). NTUplace3

- Xu, B., Li, S., et al. (2019a). Device layer-aware analytical placement for analog circuits. 

- Lin, Y., Li, Y., et al. (2022). Are analytical techniques worthwhile for analog IC placement?

![image-20251021102036831](assets/image-20251021102036831.png)




### ILP

- ç›¸å…³è®ºæ–‡ï¼š
  - ROC24: Automated placement of analog integrated circuits using priority-based constructive heuristic
  - Grus et al. (2023)  
  - Xu, B., Li, S., et al. (2017). Hierarchical and analytical placement techniques for high-performance analog circuits.  
- It is important to mention that although ILP does not scale well for large problems, the problem sizes of analog circuits are generally small, making an ILP solution tractable
- Since our layout system is built on discrete grids, integer solutions are preferred. 

### MILP

mixed-integer-programming (MILP)  

- [ICCAD20: 39, 41]  
- B. Xu et al., â€œHierarchical and analytical placement techniques for highperformance analog circuits,â€ in Proc. ISPD, 2017, pp. 55â€“62  
- MILP is limited to linear objective and constraints and its scalability is concerned. 
- it suffers from poor scalability for large-scale circuits.





## combinatorial optimization  

ç›¸å…³è®ºæ–‡ï¼š

- ROC24: Automated placement of analog integrated circuits using priority-based constructive heuristic
- pocket: additional free space around the devices  



## SMT formulation

- ç‰¹ç‚¹ï¼š

  - The flexible syntax of SMT enables efficient problem modeling and various constraint support. 
  - SMT formulas supports richer modeling expressions (e.g., if-then-else, either-or, Boolean cardinality), thus amenable for efficient, versatile formulations for placement instances

- ä»‹ç»ï¼š

  ![image-20251016105910161](assets/image-20251016105910161.png)

- ç›¸å…³è®ºæ–‡ï¼š

  - S. M. Saif et al. , â€œPareto front analog layout placement using satisfiability modulo theories,â€ in Proc. DATE, 2016, pp. 1411â€“1416.
  - DATE22:  Routability-Aware Placement for Advanced FinFET Mixed-Signal Circuits using Satisfiability Modulo Theories
  - Used in Lin et al. (2009), Dayasagar and Sudhakar (2023) and Shanthi et al. (2022),





## B*-tree/O-tree 

- ä¸€èˆ¬å’Œå¯å‘å¼æ–¹æ³•é…åˆ
- deterministic
- ç›¸å…³è®ºæ–‡
  - P.-Y. Chou, H.-C. Ou, and Y.-W. Chang, â€œHeterogeneous `b*-trees` for analog placement with symmetry and regularity considerations,â€ in Proc. ICCAD. IEEE, ==2011==, pp. 512â€“516.
  - Y. Pang, F. Balasa, K. Lampaert, and C.-K. Cheng, â€œBlock placement with symmetry constraints based on the `o-tree` non-slicing representation,â€ in Proc. DAC, ==2000==, pp. 464â€“467
  - ![image-20251022135409778](assets/image-20251022135409778.png)



## sequence pairs  

ä¸€èˆ¬å’Œå¯å‘å¼æ–¹æ³•é…åˆ

topological representation, which determines the relative positions between devices. 

![image-20251020100755950](assets/image-20251020100755950.png)

ç›¸å…³è®ºæ–‡

- ![image-20251022135342653](assets/image-20251022135342653.png)
- 

## Forced-directed approach 

Spindler, P., Schlichtmann, U., and Johannes, F. M. (2008). Kraftwerk2â€”A fast force-directed quadratic placement approach using an accurate net model.



- ç›¸å…³è®ºæ–‡ï¼š

  - originally proposed in Murata et al. (1996). It utilizes two permutations of devices, which encode the placement. Authors of Balasa and Lampaert (1999) extend this representation to handle crucial features such as symmetry groups. The sequence pair representation was further extended to handle general constraints such as abutment (two devices are placed exactly next to each other) in 

  - Ma et al. (2011), and this work finally became the core of the placer of the open-source tool ==ALIGN== (Dhar et al., 2021).
  
  - Oliveira, J. F., Junior, A. N., et al. (2016). A survey on Â´heuristics for the two-dimensional rectangular strip `packing problem`. Pesquisa Operacional, 36:197â€“226.



# æ•°æ®é›†

### MAGICAL

- ![image-20251015111556317](assets/image-20251015111556317.png)
- <img src="assets/image-20251020154710476.png" alt="image-20251020154710476" style="zoom: 55%;" />
- <img src="assets/image-20251020154730583.png" alt="image-20251020154730583" style="zoom: 65%;" />

### ALIGN

consisting of 1390 OTA circuits, including bias networks



### MCNC

  ![image-20251017101706006](assets/image-20251017101706006.png)

### GSRC

  ![image-20251017101723040](assets/image-20251017101723040.png)



### AMSnet

[AMSnet 2.0: A Large AMS Database with AI Segmentation for Net Detection](https://amsnet2-0.github.io/AMSNet2.0.github.io/)

### AICircuit

aiccircuit æ˜¯ä¸€ä¸ªå…¨é¢çš„å¤šå±‚æ¬¡æ•°æ®é›†å’ŒåŸºå‡†ï¼Œç”¨äºå¼€å‘å’Œè¯„ä¼°æ¨¡æ‹Ÿå’Œå°„é¢‘ç”µè·¯è®¾è®¡ä¸­çš„ ML ç®—æ³•ã€‚aiccircuit åŒ…æ‹¬ä¸ƒä¸ªå¸¸ç”¨çš„åŸºæœ¬ç”µè·¯å’Œä¸¤ä¸ªç”±å¤šä¸ªç”µè·¯å—ç»„æˆçš„å¤æ‚æ— çº¿æ”¶å‘å™¨ç³»ç»Ÿï¼Œæ¶µç›–äº†å®é™…åº”ç”¨ä¸­é‡åˆ°çš„å„ç§è®¾è®¡åœºæ™¯ã€‚æˆ‘ä»¬å¹¿æ³›è¯„ä¼°äº†æ•°æ®é›†ä¸Šçš„å„ç§ ML ç®—æ³•ï¼Œæ­ç¤ºäº† ML ç®—æ³•åœ¨å­¦ä¹ ä»è®¾è®¡è§„èŒƒåˆ°æ‰€éœ€ç”µè·¯å‚æ•°çš„æ˜ å°„æ–¹é¢çš„æ½œåŠ›ã€‚



# ç»¼è¿°

### -routing-IEEE Access-2023-Analog Integrated Circuit Routing Techniques: An Extensive Review---

#### Background

- as A/RF design moved into ==advanced integration technology nodes==, the increasing number of design rules/constraints, wire resistance, congestion, and interwire parasitic growth is constantly challenging existing automatic routing techniques and keeping pressure on their improvement.  average number of layout design rules contained in process design kits (PDKs) has escalated from below 1000 rules in 180/130-nanometer nodes to more than 10 times in 22-nanometer and below [5]

- In the analog domain, it is widely acknowledged that circuits/systemsâ€™ performance is critically dependent on the ==parasitic== structures induced by the layout. Thus, analog routing has historically been a handcrafting process, requiring a different level of attention and detail than its digital counterpart

- designers are usually ==skeptical== about the success/reliability of other routing tools with a higher level of automation, as they usually involve non-systematic/stochastic processes

- PiS & LaS flow

  ![image-20251011085357369](assets/image-20251011085357369.png)

- Language: BALLISTIC [21], MSL [22]

- procedural routing generators (PRGs)  method:

  ![image-20251011085330439](assets/image-20251011085330439.png)

- template-based routing generators (TbRGs)  

  They are particularly useful when a validated previously designed layout, i.e., a legacy layout, has to be migrated to other(s) close/similar technology node(s) or changes in the design are needed.

  ![image-20251011085347651](assets/image-20251011085347651.png)

- sequential path-finding generators (SPfGs).  

  ![image-20251011103020675](assets/image-20251011103020675.png)

- æ¨¡æ‹Ÿå¸ƒçº¿ä¸­ç ”ç©¶æœ€å¹¿æ³›çš„ä¸¤ç§éç†æƒ³ç°è±¡æ˜¯ç”µè¿ç§»å’Œ IR å‹é™ã€‚ç”µè¿ç§»æŒ‡çš„æ˜¯åœ¨é«˜ç”µæµå¯†åº¦ä½œç”¨ä¸‹ï¼Œç”µæºç½‘ç»œå’Œä¿¡å·çº¿ä¸­çš„ææ–™è¿ç§»ï¼› IR å‹é™åˆ™æ˜¯ç”±äºäº’è¿çº¿ç”µé˜»å¯¼è‡´çš„ç½‘ç»œç”µå‹æ³¢åŠ¨ï¼Œä¼šå½±å“ç”µè·¯æ€§èƒ½ã€‚è¿™äº›éç†æƒ³ç°è±¡æœ€ç»ˆå¯ä»¥é€šè¿‡ä½¿ç”¨å…·æœ‰ ==å¯å˜çº¿å®½çš„å¸ƒçº¿ç®—æ³•== æ¥ç¼“è§£

- integer linear programming (ILP) and evolutionary routing generators

  åŒæ—¶å¤„ç†æ‰€æœ‰ç½‘ç»œ  

  ![image-20251011104133697](assets/image-20251011104133697.png)

- ML

  ![image-20251011105759005](assets/image-20251011105759005.png)

- ARouter Timeline

  ![image-20251011112036223](assets/image-20251011112036223.png)

  <img src="assets/image-20251011112410945.png" alt="image-20251011112410945" style="zoom: 60%;" />

  <img src="assets/image-20251011112814149.png" alt="image-20251011112814149" style="zoom: 60%;" />




### --ASP DAC-2024-Performance Driven Analog Layout Automation: Current Status and Future Directions--CUHK Bei Yu

#### Background

- Conventionally, research in academic analog place-and-route (PNR) algorithms often targets the optimization of proxy objectives, such as wire length and area [1].  Such an approach fails to reveal the

  capability of the automation algorithms for important metrics such as performance and manufacturability.

- template-based methods

  - utilize user-defined layout patterns or floorplans to implement the layout
  - BAG [2] and LAYGO [3], [4]  

- a general and effective approach to considering post-layout circuit performance remains an open question.

- Analog circuit performance is highly sensitive to layout intricacies and can be adversely affected by layout parasitics, coupling, and noise

- Manual design often relies on experience, design expertise, and trial-and-error to search for a satisfactory layout.

- Symmetry constraints have played a crucial role in analog layout design

- 






### Challenges and opportunities toward fully automated analog layout design-JoS20-DZP








  # Placement

  Routability-aware placement for advanced finfet mixed-signal circuits using satisfiability modulo theories

  

  ## Placer-stochastic

  SA/

  ### [TCAD10-SA-EFYY]()

  - 

  

  ## Placer-analytical   

  ### [-system signal flow-ICCAD20--UTA]()

  - [OpenSource!](https://github.com/krzhu/IdeaPlaceEx)
  - non-linear programming-based (`NLP`) `global placement` 
  - linear-programming-based (`LP`) legalization, minimizing the ==area and wirelength==.  
  - we spread the modules considering the placement objectives and the constraint penalties using `gradient descent-based optimization`. 
  - 

  

  #### background

  - However, the `hyper-edge net models` often underestimate the importance of the ==directions of signals==

  - problem1: éœ€è¦çš„æ˜¯å…³é”®ä¿¡å·çº¿çš„çº¿çŸ­äº›

    <img src="assets/image-20251014094436896.png" alt="image-20251014094436896" style="zoom: 50%;" />

    <img src="assets/image-20251014094532891.png" alt="image-20251014094532891" style="zoom: 45%;" />

  - privious work: 

    <img src="assets/image-20251014094800145.png" alt="image-20251014094800145" style="zoom: 45%;" />

  - current flow-related constraints: the direct current from the ==supply (VDD) to the sink (VSS)== is constrained to be monotonic in one direction

    - [28, 31, 36, 37]  
    - such constraints are not easy to be extended to general ==signals and system-level circuits.==  

    

  

  

  #### contribution

  - NLP-based global placement 

    leveraging the prior knowledge of ==power/ground== routing in analog layouts  

  - a holistic method to update the parameters and multipliers

  

  

  #### flow

  ![image-20251014112051182](assets/image-20251014112051182.png)

  ![image-20251014160747652](assets/image-20251014160747652.png)

  

  #### model

  ##### NLP for GP:

  - ç›®æ ‡å’Œçº¦æŸ

    ![image-20251014140542605](assets/image-20251014140542605.png)

  - overlap è®¡ç®—

    ![image-20251014140714579](assets/image-20251014140714579.png)

  - å¯¹ç§°è®¡ç®—

    ![image-20251014140806211](assets/image-20251014140806211.png)

    > [!TIP]
    >
    > è¿™é‡Œåªå†™äº†ä¸€ä¸ªæ–¹å‘çš„

  - æ›´è¯¦ç»†çš„ç›®æ ‡ï¼š

    ![image-20251014141138007](assets/image-20251014141138007.png)

    - SSF

      ![image-20251014142423654](assets/image-20251014142423654.png)

    - SWL

      HPWL+log-sum-exponential (LSE)  

      ![image-20251014142643048](assets/image-20251014142643048.png)

    - PWL

      (PG) nets are often routed in a different approach from the signals

      the pins of PG nets are more likely to be individually connected to the current supply/sink

      for the PG nets 

      - pins are considered separately instead of being modeled as in a net-wise ==hyper-edge==
      - only the ==vertical distance== to the current supply/sink is considered.

      ![image-20251014143248812](assets/image-20251014143248812.png)

    - CRF

      - `ğ›¾ğ¶ğ‘…ğ¹`  is a parameter to control the smoothness and accuracy of the LSE approximation

    - OVL

      - smoothed version of Equation 1  

    - ASYM

      - The asymmetry penalty is the smoothed version of Equation 2   

      

  ##### ADAM optimizer  

  ##### ğ€ settings  

  ##### ğœ¸ settings

  

  ##### Legalization  

  - based on the plane sweep line algorithm from [9]  
  - ![image-20251014160658042](assets/image-20251014160658042.png)
  - 

  #### experiment

  ![image-20251014092807654](assets/image-20251014092807654.png)

  - used detailed router [5]  
  - We achieve 34%, 23%, and 10% reductions in area, routed wirelength and number of VIAs over [40]
  - ![image-20251014160834424](assets/image-20251014160834424.png)
  - ![image-20251014161451615](assets/image-20251014161451615.png)
  - ![image-20251014161525242](assets/image-20251014161525242.png)
  - ![image-20251014161600273](assets/image-20251014161600273.png)
  - 

  

  #### 

  ### [-GAN+Well Generation-ASPDAC22-GAN-UTA]()

  - analytical well-aware non-linear programming-based analog placer

  - formulate the `well proximity effect (WPE)` handling as constraints and solve them in our placement engine.

  - uses a `generative adversarial network (GAN)` for generating wells and guides the placement process

  - optimizes for area and wirelength.

  - å‰ç½®å·¥ä½œï¼š

    - `WellGAN`: Generative-adversarial-network-guided well generation for analog/mixed-signal circuit layout. `WellGAN`  generates the wells after the placement which might be ==sub-optimal==
    - `NLP` Placer ç±»ä¼¼ [ICCAD20 SSF]() é‚£ç¯‡

  - to reduce area and half-perimeter wirelength  

  - problem formulation

    ![image-20251015133923413](assets/image-20251015133923413.png)

    ![image-20251015133935489](assets/image-20251015133935489.png)

  - 

  #### background

  - what is well:

    ![image-20251015130844365](assets/image-20251015130844365.png)

  - automatic layout frameworks often use individual wells for each PMOS, e.g., ALIGN [3] and MAGICAL [4], [5].

  

  #### contribution

  - propose a new well-aware placement methodology  
  - consider wells as fence region constraints  
  - formulate WPE as minimum device-well-edge distance constraints and propose an efficient well legalization algorithm.

  

  #### flow

  ![image-20251015133601567](assets/image-20251015133601567.png)

  <img src="assets/image-20251015134723471.png" alt="image-20251015134723471" style="zoom: 70%;" />

  

  #### model

  ##### GAN

  ![image-20251015132854116](assets/image-20251015132854116.png)

  <img src="assets/image-20251015133125234.png" alt="image-20251015133125234" style="zoom: 65%;" />

  ##### WPE

  ![image-20251015133342779](assets/image-20251015133342779.png)

  ![image-20251015133552450](assets/image-20251015133552450.png)

  ##### NLP Placer

  - NLP ç›®æ ‡ï¼š

    ![image-20251015135253191](assets/image-20251015135253191.png)

  - 

  

  #### data

  from `WellGAN`ï¼š(OTA) with different architectures (OTA1, OTA2, OTA3, and OTA4), two comparators with the same topology but with different sizing (COMP1 and COMP2), a bootstrap switch (BOOTSTRAP), and a resistor digital-to-analog converter unit (RDAC). 

  

  #### experiment

  baseline:

  - The first baseline uses individual wells, denoted as â€œindividual wellsâ€
  - second baseline is to generate wells after placement using GANbased well generation, denoted as â€œWellGAN after placementsâ€.  

  ##### single well type

  ![image-20251015141032575](assets/image-20251015141032575.png)

  ##### multi-well type

  <img src="assets/image-20251015141354021.png" alt="image-20251015141354021" style="zoom: 50%;" />

  

  ![image-20251015141538992](assets/image-20251015141538992.png)

  

  ##### WPE effect

  ![image-20251015141656409](assets/image-20251015141656409.png)

  ### ePlace A-NLP+GNN-DATE22-Are Analytical Techniques Worthwhile for Analog IC Placement-TAU

  - GNN
  - Device Flipping  
  - [privious work](): J. Lu et al., â€œePlace-MS: Electrostatics-based placement for mixed-size circuits,â€  IEEE TCAD, vol. 34, no. 5, pp. 685â€“698, 2015
  - results indicate that not every analytical technique is superior to simulated annealing in solution quality.
  - it is widely recognized that analog circuit performance can be seriously affected by the quality of placement [18], [19], most existing placement techniques are unable to directly optimize performance. 

  #### background

  

  #### contribution

  - ![image-20251020190609756](assets/image-20251020190609756.png)
  - ![image-20251020191213196](assets/image-20251020191213196.png)

  

  

  #### flow

  - `global placement` based on `NLP` and a stage of `legalization and detailed placement`. 

  ![image-20251020190851888](assets/image-20251020190851888.png)

  

  #### model

  ##### GP: NLP

  ![image-20251020190105098](assets/image-20251020190105098.png)

  ![image-20251020190509990](assets/image-20251020190509990.png)

  ![image-20251020190518079](assets/image-20251020190518079.png)

  

  ![image-20251021110348083](assets/image-20251021110348083.png)

  ##### Legalization and Detailed Placementï¼šILP

  - device flipping  
  - ![image-20251021112427985](assets/image-20251021112427985.png)
  - ![image-20251021112422638](assets/image-20251021112422638.png)

  

  #### data

  The testcases include three Operational Transconductance Amplifier (OTA) designs, two comparator designs, two Voltage Controlled Oscillator (VCO) designs, an analog adder, a Variable Gain Amplifier (VGA) and an Switched Capacitor Filter (SCF). 

  GF12nm PDK  

  #### experiment

  ![image-20251021113910891](assets/image-20251021113910891.png)

  ![image-20251021113939595](assets/image-20251021113939595.png)

  ![image-20251021114037843](assets/image-20251021114037843.png)

  

  

  ### [-ILP+COR24Pre- ICORES23--STM]()

  - Our proposed ILP solution derives its core ideas from approaches used for general `rectangle packing problem` (Korf et al., 2010; Berger et al., 2009). 
  - [FLP é—®é¢˜](https://blog.csdn.net/JESSIENOTCAR/article/details/134990427)
  - BCD å·¥è‰º

  

  #### background

  

  

  #### contribution

  - ILP formulation of the placement problem.  
  - Method based on `force-directed graph drawing (FDGD)` for finding partial initial solution used as a warm start to ILP model, which significantly improves the performance of the utilized `Gurobi` (Gurobi Optimization, LLC, 2021) solver.

  

  #### model

  ##### constraintion

  ![image-20251020110640942](assets/image-20251020110640942.png)

  ###### block

  ![image-20251020110826238](assets/image-20251020110826238.png)

  ###### Aspect Ratio  

  ![image-20251020111216242](assets/image-20251020111216242.png)

  ##### FDGD 

  èƒŒæ™¯ï¼š

  ![image-20251020131003218](assets/image-20251020131003218.png)

  ä¸€ä¸ªç»§ç»­æ”¹è¿›çš„ç‚¹ï¼ša number of decision variables grows quadratically with an increasing number of independent rectangles to be placed.

  ![image-20251020131947552](assets/image-20251020131947552.png)

  #### data

  ![image-20251020132602890](assets/image-20251020132602890.png)

  #### experiment

  - Gurobi ILP solver v9.1.2  
  - four threads 

  

  ![image-20251020132553130](assets/image-20251020132553130.png)

  ![image-20251020132626872](assets/image-20251020132626872.png)

  ![image-20251020133252845](assets/image-20251020133252845.png)

  > [!TIP]
  >
  > éƒ½æ¯”æ‰‹å·¥çš„å·® 

  ### [-Priority-based+associated constraints -COR24-CO+heuristic+RL-]()

  - build on our previous conference papers (Grus et al., 2023; Grus and HanzÃ¡lek , 2024), and FLP (KubalÃ­k et al., 2019).
  - Method based on `force-directed graph drawing (FDGD)` for finding partial initial solution used as a warm start to ILP model, which significantly improves the performance of the utilized `Gurobi` solver

  #### background

  - ![image-20251017133247822](assets/image-20251017133247822.png)

  

  #### contribution

  - associated constraints  
  - Priority-based constructive heuristic inspired by KubalÃ­k et al. (2019) maps each indirect representation to a feasible placement

  #### flow

  

  #### model

  ##### constraints  

  ![image-20251017135343944](assets/image-20251017135343944.png)

  ![image-20251017135351981](assets/image-20251017135351981.png)

  ![image-20251017135413769](assets/image-20251017135413769.png)

  ![image-20251017135429896](assets/image-20251017135429896.png)

  ![image-20251017135610198](assets/image-20251017135610198.png)

  ![image-20251017135742129](assets/image-20251017135742129.png)

  ![image-20251017140058223](assets/image-20251017140058223.png)

  ![image-20251017140248776](assets/image-20251017140248776.png)

  ![image-20251017140425705](assets/image-20251017140425705.png)

  ###### å¯¹ç§°çº¦æŸ

  æ³¨æ„ä¸€ä¸ª G åªæœ‰ä¸€ä¸ª x~G~

  ![image-20251017141018905](assets/image-20251017141018905.png)

  ![image-20251017141033293](assets/image-20251017141033293.png)

  ![image-20251017141209356](assets/image-20251017141209356.png)

  ![image-20251017141350285](assets/image-20251017141350285.png)

  ![image-20251017141436186](assets/image-20251017141436186.png)

  

  ###### ç‰ˆå›¾å½¢çŠ¶

  ![image-20251017142252546](assets/image-20251017142252546.png)

  ###### å®½é«˜æ¯”

  ![image-20251017143852240](assets/image-20251017143852240.png)

  ###### **é¢ç§¯è¿‘ä¼¼**

  ![image-20251017143905923](assets/image-20251017143905923.png)

  ![image-20251017144042835](assets/image-20251017144042835.png)

  ![image-20251017144534371](assets/image-20251017144534371.png)

  ##### Constructive heuristic  

  

  

  #### data

  

  #### experiment

  

  

  ### [AIPlacer-GNN unsupervised-ASPDAC25--USTC]()

  - the first multi-task learning model for analog placement automation.

  - baseline: [DAC21]()

  - Concept of `global position` is interesting

    <img src="assets/image-20251022103121263.png" alt="image-20251022103121263" style="zoom: 40%;" />

  - > [! WARNING]
    >
    > è¿™é‡Œçš„éç›‘ç£å…¶å®å’Œ NLP æ˜¯å·®ä¸å¤šçš„æ¦‚å¿µï¼Ÿâš ï¸ éç›‘ç£ä½†æ˜¯ä¹Ÿåˆ†äº†æµ‹è¯•é›†å’Œè®­ç»ƒé›†
    >
    > æ²¡æœ‰æ `Legalization`ï¼Ÿæ˜¯ä¸éœ€è¦å—ï¼Ÿ

  #### background

  - Although recent works have investigated ML-based analog placement automation, these arts face complex training datasets and efficiency challenges.   

  

  #### contribution

  - the first multi-task learning model for analog placement automation.
  - A practical scheme  
  - An unsupervised loss function  

  #### flow

  ![image-20251022095910268](assets/image-20251022095910268.png)

  ##### Input  

  - a SPICE netlist(an un-directed graph)

    - node feature(12 dim):

      - (length and width) , 2 dim 

      - device type (i.e., NMOS, PMOS, PASSIVE), 3 dim

      - global positional info (5 dim)

        - calculate the shortest path from the POWER(GND) port to PMOS (NMOS), respectively. The shortest path length refers to the device position, which is transformed into a 5-dimensional one-hot vector. 

        - the global position of the device is highly consistent with the actual order of ==current flows== in the circuit (shown in the red arrow).

        - ![image-20251022101101592](assets/image-20251022101101592.png)

        - > [! WARNING]
          >
          >å›ºå®šåªèƒ½æœ‰ 5 ä¸ª dim æ„Ÿè§‰ç”µè·¯å¦‚æœå†å¤§ç‚¹å°±ä¸é€‚é…äº†

      - init positional info (2 dim)  

        ![image-20251022101821521](assets/image-20251022101821521.png)

    - constraint relation

      - ![image-20251022103328667](assets/image-20251022103328667.png)

      - ğ‘´1 matrix: ![image-20251022103442426](assets/image-20251022103442426.png)

        >[!WARNING]
        >
        >æ˜¯å¦ä¼šæœ‰ä¾‹å¤–ï¼Ÿ

      - ğ‘´2 matrix: 

        å¯¹ç§°ä¿¡æ¯

        > [!TIP]
        >
        > æ²¡æœ‰åŒºåˆ† x/y å¯¹ç§°ï¼Œè¿˜æœ‰å¯¹ç§°ç»„ï¼Ÿ
        >
        > æ„Ÿè§‰è¿˜æœ‰å¾ˆå¤§æå‡ç©ºé—´

      - ğ‘´3 matrix: 

        current-flow VDD2VSS

  #### mode

  - **GAT** to realize the feature interactions between nodes. 
  - **RGCN** for constraint relation
    - ![image-20251022105510073](assets/image-20251022105510073.png)
  - **MTN** Decoder  
    - MMOE-based
    - <img src="assets/image-20251022110342890.png" alt="image-20251022110342890" style="zoom: 55%;" />

  ##### loss

  > æ— ç›‘ç£æ„Ÿè§‰å°±æ˜¯æƒ³ NLP ä¸€æ ·æ‰¾æœ€å°å€¼ï¼Ÿ

  ![image-20251022112547681](assets/image-20251022112547681.png)

  ![image-20251022112609186](assets/image-20251022112609186.png)

  ![image-20251022112618046](assets/image-20251022112618046.png)

  ![image-20251022112622707](assets/image-20251022112622707.png)

  ![image-20251022112630063](assets/image-20251022112630063.png)

  ![image-20251022112634881](assets/image-20251022112634881.png)

  

  

  #### data

  - TSMC180

  - 13 type ==**OTA only**==

    

  

  #### experiment

  - âš ï¸ éç›‘ç£ä½†æ˜¯ä¹Ÿåˆ†äº†æµ‹è¯•é›†å’Œè®­ç»ƒé›†

  - ![image-20251022113927606](assets/image-20251022113927606.png)

  - ![image-20251022113931810](assets/image-20251022113931810.png)

    > `global position` åˆ†å¼€çš„å¾ˆæ˜ç¡®

  - Ablation Study  

    ![image-20251022114054367](assets/image-20251022114054367.png)

    

  

## Placer-DL



### [SACPlace-MADRL+symmetry-DATE25-MADRL-CAS]()

- 

#### background

- ![image-20251023135142915](assets/image-20251023135142915.png)
- 

#### contribution

- symmetry-aware  
- introduce cumulative rewards  
- multi-agent  



#### flow

SACPlace initially extracts layout information and various constraints as the input information for placement refinement and evaluation.

![image-20251023141038136](assets/image-20251023141038136.png)



#### model

![image-20251023140803790](assets/image-20251023140803790.png)

![image-20251023140846373](assets/image-20251023140846373.png)

- ==each device== to be placed is treated as an individual ==agent==
- Initially, all devices are intentionally overlapped to facilitate the forward progress of DRL optimization.

##### state

![image-20251023142752590](assets/image-20251023142752590.png)

##### action

action space A ensures symmetrical actions  

![image-20251023143047529](assets/image-20251023143047529.png)

![image-20251023143011197](assets/image-20251023143011197.png)

##### reward

![image-20251023143026188](assets/image-20251023143026188.png)

![image-20251023143128437](assets/image-20251023143128437.png)

![image-20251023143137543](assets/image-20251023143137543.png)

![image-20251023143150167](assets/image-20251023143150167.png)



##### MARL

> æ²¡çœ‹æ‡‚



#### data

![image-20251023144002040](assets/image-20251023144002040.png)

> SAGERoute!

#### experiment

- compare different SOTA DRL approaches  

- ![image-20251023144230270](assets/image-20251023144230270.png)

  > éƒ½æ˜¯å’Œ RL çš„æ–¹æ³•æ¯”è¾ƒï¼Œå’Œ Virtuoso çš„è‡ªåŠ¨å¸ƒå±€å¸ƒçº¿
  >
  > Virtuoso, struggles to adequately meet symmetry constraints  

- ![image-20251023144422911](assets/image-20251023144422911.png)

- ![image-20251023144554394](assets/image-20251023144554394.png)



  ## Placer-other

  ### [-Interactive Layout Editing+instant legalization-DAC21--PEK Gao, Lin]()  

  - legalization 
  - äº¤äº’çš„
  - adopt analog placement engine of MAGICAL [2] to generate the initial placement results shown to the users. 

  #### background

  - shortcoming of full-auto flow

    ![image-20251015091730344](assets/image-20251015091730344.png)

  - In other words, designers expect a tool to improve their productivity but still have full control over the design process.

  - So far, developing an end-to-end flow that can generate highquality and stable solutions is still challenging, as it is hard to define a universal analytical objective for analog layout problems.

  - 

  

  #### contribution

  - `interactive analog placement` framework that supports ==commands== for fast layout editing  
  - an instant `legalization algorithm` for incremental layout update with ==linear time complexity==
  - Experimental results on open-source analog circuits such as comparators, amplifiers, and data converters demonstrate that the framework can enable efficient layout editing and reduce the turn-around time for layout designers.

  

  #### flow

  ![image-20251015095802524](assets/image-20251015095802524.png)

  - All events on the interface are encoded as commands.  
  - 

  

  #### model

  ##### command set

  ![image-20251015100823071](assets/image-20251015100823071.png)

  ##### constraint graph   

  

  ##### Instant Legalization  

  ![image-20251015102613744](assets/image-20251015102613744.png)

  ![image-20251015101652692](assets/image-20251015101652692.png)

  legalizer can handle both flat circuits and hierarchical circuits.  For hierarchical circuits, the legalization process starts with the leaf-level subcircuits in the circuit hierarchy tree.

  

  ##### MCG(G^M^)

  ![image-20251015102654826](assets/image-20251015102654826.png)

  æœ‰å‘æ— ç¯å›¾ directed acyclic graph (DAG)  

  ![image-20251015103309803](assets/image-20251015103309803.png)

  linear ordering S ={v2; v1; v5; v3; v4}  

  ![image-20251015104040089](assets/image-20251015104040089.png)

  

  ##### Layout Partitioning  

  two symmetry groups  

  ![image-20251015104442779](assets/image-20251015104442779.png)

  ![image-20251015104542827](assets/image-20251015104542827.png)

  

  ##### topo-sort based legalization  

  > [!TIP]
  >
  > å‰é¢æ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œä¹‹åå†çœ‹çœ‹

  ![image-20251015105642908](assets/image-20251015105642908.png)

  

  #### experiment

  ![image-20251015110029781](assets/image-20251015110029781.png)

  > [!WARNING]
  >
  > A~2~æ˜¯ä»€ä¹ˆï¼Ÿ

  æ¯” MAGICALï¼ˆåŸºäº LPï¼‰çš„å¿«å¾ˆå¤š

  ![image-20251015111504972](assets/image-20251015111504972.png)

  

  

  ## Placer-adv

  ### [-AMS+FinFET-DATE22--DZP]()

  - FinFET

  - SMT formulation

  - problem formulationï¼š

    

  #### background

  - FinFET reigon-based layout æ–°å¢çš„ constraint:

    ![image-20251016103049745](assets/image-20251016103049745.png)

  - ä¸¤ä¸ªç›¸å…³ privious works

    - <img src="assets/image-20251016105124494.png" alt="image-20251016105124494" style="zoom: 50%;" />
    - <img src="assets/image-20251016105323503.png" alt="image-20251016105323503" style="zoom: 45%;" />

  - 

  

  #### contributuion

  - an `SMT-based` placement framework targeting a new `region-based` layout for advanced FinFET AMS designs
  - a `window-based` pin density checking SMT formulation for placement routability consideration.
  - leverage `incremental SMT` solving techniques for efficient wirelength optimization, enabling the application of our framework to `large-scale designs.`

  

  #### experiment

  - Z3 SMT solver  

  - å•†ç”¨æ•°æ®é›†ï¼šBUF, VCO

    ![image-20251016111324440](assets/image-20251016111324440.png)

  - TSMC 5nm

  - use [ICCAD20]() analog router [18]

  

  ## POpt-DL

  ### [-survey ML+SA-ISVLSI20--UTA-]()

  - ä¸€ä¸ªå®éªŒæ€§è´¨çš„å¯¹æ¯”å·¥ä½œï¼ŒNN, RF, SVM
  - Placer åŸºäº [TCAD10-SA-EFYY]() çš„å·¥ä½œ
  - OTA only
  - ![image-20251013101351269](assets/image-20251013101351269.png)

  #### background

  - most of the previous works are focused on geometric constraint

  - the impact of layout on analog circuit performance can be very large due to significant RC (Resistance and Capacitance) parasitic generated in layout.

  - ![image-20251013092848932](assets/image-20251013092848932.png)

  - the layout effect on performance is often very complex and thus difficult to be quickly and accurately estimated

  - 

    

  #### contribution

  - directly optimizes circuit performance during placement
  - It can directly optimize analog circuit performance along with conventional objectives, including wirelength, area and geometric constraints such as symmetry constraints

  

  #### experiment

  ![image-20251013102653336](assets/image-20251013102653336.png)

  ### [-Placement Quality Prediction via Transfer Learning-DATE20-CNN-UTA]()

  - OTA only
  - a new methodology to shorten the gap in post layout performance modeling for analog circuits.
  - Magical  to generate layouts
  - [Opensource!](https://github.com/magical-eda/UT-AnLay  )

  

  #### background

  - hand-crafted constraints are often questionable in explainability and confidence, and lack flexibility and generality in meeting the detailed needs of different scenarios. 
  - a mapping between a given layout and the expected post layout performance is imperative yet still challenging
  - One major bottleneck of design exploration is the runtime involved with post layout simulations. 

  #### contribution

  - proposed approach leverages an automatic flow to generate high-quality labeled training data
  - a transfer learning scheme that significantly reduces the amount of data needed during training

  

  #### model

  ![image-20251014091716280](assets/image-20251014091716280.png)

  

  #### data

  create a balanced data with the worst performing  25th percentile layout labeled as 1 and the best 

  25th as 0. ï¼ˆåˆ†ç±»ï¼‰

  ä»–è¯´çš„æ•°æ®å‰ªæè²Œä¼¼å°±æ˜¯åˆ†ç±»ä¸º 0 çš„ç”µè·¯åªé€‰æ€§èƒ½ 25%ä»¥ä¸‹çš„ï¼Œ1 çš„ç”µè·¯åªé€‰ 75%ä»¥ä¸Šçš„

  we propose divide the circuit into the following subcircuits based on functionality

  ![image-20251014084633650](assets/image-20251014084633650.png)

  In all our experiment, the image size is selected to be 64*64. 

  ![image-20251014085026977](assets/image-20251014085026977.png)

  ![image-20251014085035527](assets/image-20251014085035527.png)

  

  #### experiment

  ![image-20251014085547313](assets/image-20251014085547313.png)

  ![image-20251014085836060](assets/image-20251014085836060.png)

  

  ### [-Constraint Evaluation-ASPDAC21-SVM+MLP-]()

  - åŸºäº [TCAD10-SA](#TCAD10-SA-EFYY) æ–¹æ³•çš„ Placer
  - testcase: three 12nm OTA 

  #### background

  - the interconnect parasitic correlation may not be linear over the search space

  #### experiment

  

  ### [-Analog Placement Quality Prediction-ASPDAC23-NAS-DU]()

  - [DATE20]() çš„å»¶ä¼¸ï¼Œå°±æ˜¯ç”¨ NAS ä¼˜åŒ–äº†ä¸€ä¸‹ï¼Ÿ
  - NAS: [ ç¥ç»æ¶æ„æœç´¢ï¼ˆNASï¼‰ç®€è¦ä»‹ç» - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/127194745)
  - 

  #### background

  - Severalrecent studies apply machine learning (ML) techniques to directly predict the impact of placement on circuit performance or even guide the placement process. However, the significant diversity in analog design topologies can lead to different impacts on performance metrics (e.g., common-mode rejection ratio (CMRR) or offset voltage). 
  - 

  

  #### data

  using the same open-sourced dataset and the same setting as the work [DATE20]()

  

  

  # Routing

  ### LDSâ€”A description script for layout templates

  ### BAG

  - grid and template-based 

  ### LAYGO1

  - grid and template-based 
  - ç±»ä¼¼ [BAG](# BAG)

  

  ### LAYGO2

  - [OpenSource!](https://github.com/niftylab/laygo2)

  

  

  

  ### Analog and mixed-signal layout automation using digital place-and-route tools

  - digital PR tools base
  - a fully automated solution where the physical design process is treated as an optimization process.

  



# DTCO

### [-BO+closed loop+SSF post-DAC20--UTA]()

- closed loop

- [MAGICAL]() çš„ä¸€éƒ¨åˆ†

- problem formulation

  ![image-20251021190625931](assets/image-20251021190625931.png)

#### background

#### contribution

- closed loop
- automatic symmetry constraint detection both between devices and subcircuits
- 

#### flow

![image-20251021193214407](assets/image-20251021193214407.png)

![image-20251021193203544](assets/image-20251021193203544.png)

> DFS-based





#### model

- Gaussian process regression (GPR) and MOBO

- classify symmetry constraints into two categories  

  - Device Symmetry, graph isomorphic algorithms
  - System Symmetry

- Close loop:

  ![image-20251021201308144](assets/image-20251021201308144.png)



#### data

#### experiment

- GPflow  to do MOBO



# Gate Sizing

### [- -DAC-2024-MARL-Mohsen et al-]()

- Model-Based Policy Optimization (MBPO) to highly boost the sample efficiency of reinforcement learning for analog circuit sizing  
- Integrated in the Twin Delayed DDPG (TD3) algorithm  
- 

### [PZTA-Transferable Circuit Theory-Inspired-ISEDA-2025- -Fudan-]()

- a transferable pole-zero-based transient assertion (PZTA) system



#### background

- Transient simulation is a major computational bottleneck in analog circuit sizing optimization, especially when

  the circuit is unstable.

- Simulation-based methods achieve high accuracy but suffer from inefficiency, while surrogate-based ap

  proaches promise speedups but struggle with prediction errors and high computational costs. 



### Routing

- æ¦‚ä¼¦å’ŒåŒ—å¤§åˆä½œçš„
- for analog/mixed-signal integrated circuits.  



#### background

- Most previous work has focused only on ==geometric constraints== or basic ==electrical constraints==, lacking ==holistic== and ==systematic== investigation.
- categorize routing constraints intoï¼š
  -  geometric constraints (e.g., design rules) 
  - electrical constraints (e.g., EM and IR drop constraints on power/ground nets, symmetry nets, sensitive area constraint, etc.)
- privious worksâ€˜ limitation
  - no tackles multiple constraints  
  - ignore the differences in resistance and capacitance caused by different net routing topologies when handling EM and IR drop constraints



#### contribution

![image-20250717134247641](assets/image-20250717134247641.png)

- considers both geometric and electrical constraints  
- compatible with manually placed layouts  
- a novel Steiner tree based wire sizing scheme
  - considers both net routing topologies and wire sizes with accurate estimation of resistance and capacitance for EM and IR drop constraints
- a multi-constraint aware routing algorithm
  - work with complicated constraints and the wire sizing scheme

# Netlist Annotation & Constraint Generation  

Liu M, Li W, Zhu K, et al. S3DET: Detecting system symmetry constraints for analog circuits with graph similarity. Proc ASPDAC, 2020, 193  åŸºäºå¿«é€Ÿå›¾ç›¸ä¼¼æ€§  

Kunal K, Poojary P, Dhar T, et al. A general approach for identifying hierarchical symmetry constraints for analog circuit layout. Proc ICCAD, 2020

Kunal K, Dhar T, Madhusudan M, et al. GANA: ==Graph convolutional network based== automated netlist annotation for analog circuits. Proc DATE, 2020  

templates-based:

![image-20251022164349284](assets/image-20251022164349284.png)

knowledge-based:

![image-20251022164357347](assets/image-20251022164357347.png)

templates and knowledge-based

![image-20251022164413837](assets/image-20251022164413837.png)





# Design rule abstraction  

![image-20251022170844515](assets/image-20251022170844515.png)





# PCell Generator

### [ALIGN-opt-DATE21--]()

- ä¸€ä¸ªæ–¹æ³•ä¸Šçš„æ”¹è¿›ï¼Œä½†æ˜¯æ²¡ä»”ç»†è¯´PCellçš„ç”Ÿæˆ

#### background

- The quality of primitive cell layout is critical for design performance



## Array CC PR

![image-20251204172818005](assets/image-20251204172818005.png)

![image-20251204172833777](assets/image-20251204172833777.png)



### TOREAD

#### cap

![image-20251203152910054](assets/image-20251203152910054.png)

#### mos

![image-20251205100808025](assets/image-20251205100808025.png)

<img src="assets/image-20251205095313179.png" alt="image-20251205095313179" style="zoom: 135%;" />

> diffusion share

![image-20251203152941324](assets/image-20251203152941324.png)

![image-20251203153001203](assets/image-20251203153001203.png)





æ–‡çŒ®[13]å’Œ[14]æå‡ºäº†æ„é€ æ€§ç®—æ³•æ¥ç”Ÿæˆæ™¶ä½“ç®¡é˜µåˆ—çš„å…±è´¨å¿ƒï¼ˆCCï¼‰ç‰ˆå›¾æ¨¡å¼ã€‚å…¶ä¸­[14]è¿˜åœ¨å¸ƒå±€ç”Ÿæˆè¿‡ç¨‹ä¸­è€ƒè™‘äº†çƒ­æ•ˆåº”ã€‚ç„¶è€Œï¼Œè¿™ä¸¤é¡¹ç ”ç©¶å‡æœªè§£å†³å¸ƒçº¿é—®é¢˜ã€æ™¶ä½“ç®¡é—´æ‰©æ•£åŒºå…±äº«é—®é¢˜æˆ–å¸ƒå±€ç›¸å…³æ•ˆåº”ï¼ˆLDEsï¼‰ã€‚æ–‡çŒ®[15]æå‡ºäº†ä¸€ç§æ‰©æ•£åŒºå…±äº«æ„ŸçŸ¥çš„CCå¸ƒå±€å¸ƒçº¿ç®—æ³•ï¼Œ![image-20251203153356107](assets/image-20251203153356107.png)



![image-20251203151142265](assets/image-20251203151142265.png)

### [-Eulerian Path-ICASIC-03--Tsinghua]()

- $\mathcal{O}(n)$
- dummy insert
- two dimension cc



#### background

#### contribution

#### flow

#### model

the follow five rules should beconsidered [9]. 

1. Coincidence
2. Symmetry
3. Dispersion
4. Compactness
5. Orientation

![image-20251230144541766](assets/image-20251230144541766.png)



![image-20251230144530681](assets/image-20251230144530681.png)

#### data

#### experiment



### [Layout Symmetries--TCAD-17--]()

- arbitrary numbers of rows and columns
- applicable to all device types
- ä¸»è¦æ˜¯æ¯”è¾ƒä¸æ€»ç»“ï¼Œéå¸¸å…¨é¢
- ä½†æ˜¯åªæœ‰ABä¸¤ä¸ªå™¨ä»¶



#### contribution



#### model

##### åŒ¹é…æ¢¯åº¦æ¨¡å‹

![image-20251230154251978](assets/image-20251230154251978.png)

![image-20251230154926331](assets/image-20251230154926331.png)

![image-20251230154941365](assets/image-20251230154941365.png)

![image-20251230154948700](assets/image-20251230154948700.png)



##### å¯¹ç§°ç±»å‹

![image-20251230160306030](assets/image-20251230160306030.png)

![image-20251230160341028](assets/image-20251230160341028.png)

![image-20251230160412572](assets/image-20251230160412572.png)

![image-20251230160652955](assets/image-20251230160652955.png)

##### ç¦»æ•£åº¦



![image-20251230152246548](assets/image-20251230152246548.png)

![image-20251230152236649](assets/image-20251230152236649.png)

![image-20251230160710861](assets/image-20251230160710861.png)

![image-20251230160744405](assets/image-20251230160744405.png)

![image-20251230160825786](assets/image-20251230160825786.png)

##### ä¸‰ç§ç®—æ³•

1. è¡Œæ•°æ¨¡4ä½™1

2. è¡Œæ•°æ¨¡4ä½™3

3. è¡Œæ•°ä¸ºå¶æ•°

   ![image-20251230161311247](assets/image-20251230161311247.png)

> åªé€‚åˆä¸¤ä¸ªå™¨ä»¶ï¼ŒåŒæ—¶ä¸è€ƒè™‘abut
>
> å¤§æ•°é‡çš„äºŒç®¡å·®åˆ†å¯¹å’Œç”µæµé•œå¯ä»¥ç”¨



##### DO LINEAR GRADIENTS CANCEL IN COMMON CENTROID LAYOUTSï¼Ÿ

![image-20251230162005563](assets/image-20251230162005563.png)



#### experiment



### [-Choose pattern-DATE-21--Sharma]()

- è®¨è®ºäº†ä»€ä¹ˆæ—¶å€™ç”¨ä»€ä¹ˆpatternï¼Œ å¾ˆæ·±çš„ç†è®ºåˆ†æï¼Œ
- TODO: æ²¡çœ‹æ‡‚.
- ç»“è®º
- <img src="assets/image-20251204151246713.png" alt="image-20251204151246713" style="zoom: 85%;" />



#### background

- LDE and Variation  



### [-Performance-Aware Common-Centroid Placement and Routing-ICCAD-21--Sharma]()

- Performance-Aware:  maximizes diffusion sharing, incorporates length of diffusion (LOD) based stress-induced performance variations, and mitigates resistive parasitics and electromigration (EM) hotspots
- Placement and Routing 
- FinFET



#### background

- LDE
- ![image-20251204103519600](assets/image-20251204103519600.png)



#### flow

#### model

##### placement

![image-20251204103503323](assets/image-20251204103503323.png)

![image-20251204103453214](assets/image-20251204103453214.png)

![image-20251204094753384](assets/image-20251204094753384.png)

##### routing

EM and IR drop aware

can be reduced by identifying sensitive wires and using ==multiple parallel connections== between nodes,

**overall scheme** is to connect all cells of the same device in a row using ==horiztontal== wires, and to connect cells across rows using ==vertical== wires. 



#### experiment

env

- simulate spatial variations random fields  tool: [GeoStat-Framework/GSTools: GSTools - A geostatistical toolbox: random fields, variogram estimation, covariance models, kriging and much more](https://github.com/GeoStat-Framework/GSTools)

### [-CC nonlinear spatial variations Opt-DATE-24-SA-UTA](https://ieeexplore-ieee-org-443.webvpn.scut.edu.cn/document/10546584/)

- minimizing nonlinear spatial variations.  
- placment only
- more general: consider diffusion break, routing complexity, nonlinear spatial variations and  LDE
- not-cc
- æ²¡åä»¿

#### background

- LDE and Variation

- [14, 7] have proposed custom algorithm for symmetric transistor placement, which handles layout constraints. However, this method is limited to producing layouts of the `CC` type, making it inefficient in handling nonlinear variationsï¼Ÿ

  The method also lacks a welldefined objective in the problem formulation, hindering the ability to prioritize one constraint over another. 

  Furthermore, the layout constraints are handled separately through post-processing steps after placement, which can lead to ==sub-optimal== results.

- <img src="assets/image-20251204153031143.png" alt="image-20251204153031143" style="zoom: 35%;" />

- 



#### contribution

![image-20251204155553693](assets/image-20251204155553693.png)

#### flow

Our approach ==starts with an initial placement== of unit cells

<img src="assets/image-20251204155432166.png" alt="image-20251204155432166" style="zoom:95%;" />



#### model

##### ç©ºé—´è¯¯å·®

![image-20251204163535801](assets/image-20251204163535801.png)

![image-20251204163545968](assets/image-20251204163545968.png)

![image-20251204163558885](assets/image-20251204163558885.png)

##### å¸ƒçº¿å¤æ‚åº¦

<img src="assets/image-20251204164447501.png" alt="image-20251204164447501" style="zoom: 75%;" />

56

ğ‘‚(ğ‘›2)  

##### LODæ•ˆåº”

![image-20251204164856058](assets/image-20251204164856058.png)

![image-20251204164851521](assets/image-20251204164851521.png)

![image-20251204165112547](assets/image-20251204165112547.png)

##### Diffusion Break  

![image-20251204172336269](assets/image-20251204172336269.png)



##### SA ä¼˜åŒ–

SAé€‚åˆè¿™ç§å°è§„æ¨¡çš„é—®é¢˜

![image-20251204172501000](assets/image-20251204172501000.png)

init solution:

![image-20251204173727845](assets/image-20251204173727845.png)

Random Perturbation  

![image-20251204184759584](assets/image-20251204184759584.png)

![image-20251204185321214](assets/image-20251204185321214.png)



#### data



#### experiments

###### setting

g: random

![image-20251204190705448](assets/image-20251204190705448.png)



result

![image-20251204191514795](assets/image-20251204191514795.png)

è¿™ä¸ªç”Ÿæˆçš„patternä¸€çœ¼çœ‹ç€åº”è¯¥æŒºéš¾æ¥å—çš„

![image-20251204192107913](assets/image-20251204192107913.png)

![image-20251204192112672](assets/image-20251204192112672.png)

> [!WARNING]
>
> æ²¡è¯´æ—¶é—´ï¼Œæ²¡åä»¿
>
> ![image-20251204192245775](assets/image-20251204192245775.png)





### [-Nonlinear Gradients -TCAD-24--Sharma]()

- FinFET-Based  
- Sharma è¿™ä¸ªæ–¹å‘çš„ç¬¬ä¸‰ç¯‡
- dispersion
- optimize the placement for second-order gradients  
- routing å’Œä¹‹å‰çš„å·¥ä½œä¸€æ ·
- è¯¦ç»†é˜è¿°äº†ä¸ºä»€ä¹ˆè¦å¼•å…¥ç©ºé—´ä½ç½®çš„éçº¿æ€§æˆåˆ†
- 



#### background

- LED, EM, Variation  

- ![image-20251205103201370](assets/image-20251205103201370.png)

- ![image-20251205103152625](assets/image-20251205103152625.png)

  > [!CAUTION]
  >
  > è¿™é‡Œæ˜¯åˆ†å¼€æ¥ç›¸ç­‰ï¼Œä½†æ˜¯åœ¨[DATE24]()ä¸­ï¼Œæ¯ä¸ªcomponentå’Œèµ·æ¥ç›¸ç­‰

- ![image-20251205103505575](assets/image-20251205103505575.png)

- ![image-20251205103514870](assets/image-20251205103514870.png)



#### model

##### ä¹‹å‰çš„æ–¹æ³•ï¼š

![image-20251205112341203](assets/image-20251205112341203.png)

![image-20251205112140586](assets/image-20251205112140586.png)

> [!CAUTION]
>
> å¦‚æœæ˜¯8åˆ—
> (g)ä¸‹ä¸€æ¬¡æ”¾ç½®å°±å®Œè›‹äº†







##### new method

extensible to higher than second-order gradients, but in practice it is unlikely that such an analysis is necessary in real world scenarios.

by swapping unit cell

![image-20251205135212470](assets/image-20251205135212470.png)

![image-20251205135202673](assets/image-20251205135202673.png)

![image-20251205133058621](assets/image-20251205133058621.png)

>[!CAUTION]
>
> ![image-20251205133035907](assets/image-20251205133035907.png)



#### data/setting

![image-20251205135447899](assets/image-20251205135447899.png)



#### experiment

![image-20251205142305511](assets/image-20251205142305511.png)

![image-20251205142311113](assets/image-20251205142311113.png)

![image-20251205142255439](assets/image-20251205142255439.png)

![image-20251205142247664](assets/image-20251205142247664.png)

impact of secondorder gradients increases significantly with the ==layout size==  

![image-20251205142350505](assets/image-20251205142350505.png)

> Intel(R) Core i7 8665U CPU @1.90 GHz

![image-20251205142509367](assets/image-20251205142509367.png)

### [-Multiobjective Optimization-TCAD-25-SA-Supriyo]()

- Multi-object: degree of dispersion, routing complexity, diffusion sharing, and layout dependent effects.

- constraints, including degree of dispersion, routing complexity, diffusion sharing, and layout dependent effects.

- Supriyo ä¸Šä¸€ä¸ªå·¥ä½œçš„æœŸåˆŠï¼Œå¤šäº†å¾ˆå¤šä¸œè¥¿

- SAæ¢æˆ æ”¯æŒ==å¤šç›®æ ‡ä¼˜åŒ–==çš„ AMOSA [22]ï¼Œ ä¸éœ€è¦è°ƒå‚äº†  

  ![image-20251204201825626](assets/image-20251204201825626.png)

- CC-typeï¼Œ ä¸Šä¸€ä¸ªå·¥ä½œå¯èƒ½å‡ºç° not CC?

- å¢åŠ äº†dummy countçš„è€ƒè™‘

- å¢åŠ äº†ç¦»æ•£ç¨‹åº¦çš„

- ï¼Œæ²¡æœ‰ä½¿ç”¨

- placement only

- å¯ä»¥ä¹Ÿæ²¡ç»™run time

  > ä¹‹åå¯èƒ½å¾€é«˜é¢‘/routing/Post-Layout Awareå»åšï¼Ÿ





#### background

- LED and Variation  



#### contribution

![image-20251204202619435](assets/image-20251204202619435.png)

- XY/180Â°



#### flow

![image-20251204214330618](assets/image-20251204214330618.png)



##### init placement

![image-20251204205558760](assets/image-20251204205558760.png)

mirroring strategy of device placement using the X==X==/180  transformation proves insufficient

XY/180â—¦ transformation can be applied only to devices having the same number of units

![image-20251204211430089](assets/image-20251204211430089.png)



#### model

##### AMOSA-based

we store the solution==s== in new-ptsï¼ˆAMOSA store one solutionï¼‰

> TOREAD

![image-20251204212726442](assets/image-20251204212726442.png)

##### constration

Degree of Dispersion  

![image-20251204212138057](assets/image-20251204212138057.png)

![image-20251204212529230](assets/image-20251204212529230.png)



Layout Dependent Effects  

![image-20251204212714886](assets/image-20251204212714886.png)

![image-20251204212112221](assets/image-20251204212112221.png)

![image-20251204212745127](assets/image-20251204212745127.png)

![image-20251204212751954](assets/image-20251204212751954.png)

Routing Cost  

![image-20251204214103350](assets/image-20251204214103350.png)

![image-20251204214108804](assets/image-20251204214108804.png)

> [!CAUTION]
>
> å†æ¢æˆRSMTï¼Ÿ
>
> æœ‰è¿™ä¹ˆéº»çƒ¦å—

#### Data and Env

TSMC 40 nm PDK  

Virtuoso schematic and GXL layout environment   

==manually== create  the topology (i.e., the pattern) using the Modgen feature  

> Modgen feature æ˜¯ä»€ä¹ˆï¼Ÿ

Calibre nmLVS and PEX  

> ä¸ç”¨è¿‡DRCï¼Œä¹Ÿéš¾è¿‡

Labels and NWELL are created ==manually==  

![image-20251204220537174](assets/image-20251204220537174.png)

> æ„Ÿè§‰caseçš„å•å…ƒæ•°é‡éƒ½æŒºå¤§çš„ã€‚ä¸è¿‡å°çš„è¯å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆä¼˜åŒ–å¿…è¦

#### experiment

![image-20251204215809188](assets/image-20251204215809188.png)

![image-20251204220515336](assets/image-20251204220515336.png)

![image-20251204221428560](assets/image-20251204221428560.png)

![image-20251204221432124](assets/image-20251204221432124.png)

![image-20251204221413690](assets/image-20251204221413690.png)

![image-20251204221418141](assets/image-20251204221418141.png)



# Tools

## Generator

### PCell

- Cadence
- 

### PyCells

- related toolsï¼špycell studio
- Synopsys



### BAG1/2

- 2013/2018

- Berkeley Analog Generator (BAG)

- [OpenSource](https://github.com/ucb-art/BAG_framework)

- PyCell-based

- procedural based, users have to write significant amount of codes, limiting the wide adoption of the solutions

  ç¨‹åºæ€§å¸ƒå±€ç”Ÿæˆå™¨åœ¨å¼€å‘å‚æ•°åŒ–å•å…ƒä»¥åŠæ•´åˆç”¨äºç¼–ç å™¨ä»¶æ”¾ç½®å’Œå¸ƒçº¿çš„è„šæœ¬æ–¹é¢ä»ç„¶éœ€è¦å¤§é‡çš„äººå·¥åŠ³åŠ¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™äº›æ–¹æ³•åœ¨å°†è®¾è®¡è¿ç§»åˆ°ä¸åŒæŠ€æœ¯èŠ‚ç‚¹æ—¶å·²æ˜¾è‘—å‡å°‘äº†äººå·¥å·¥ä½œé‡ã€‚



## Netlist2GDS

### MAGICAL

- [magical-eda/MAGICAL: Machine Generated Analog IC Layout](https://github.com/magical-eda/MAGICAL)
- IDEA program  â€œno human in the loopâ€   
- 



#### flow

![image-20251015190632878](assets/image-20251015190632878.png)

- MAGICAL supports different device types, including PMOS, NMOS, MOM capacitors, and poly resisters. 
- Transistors can have additional attributes such as lvt (low threshold voltage), hvt (high threshold voltage) and na (native device)

#### files

Benchmark circuit examples are under `examples/`



#### case

three OTA

one COMP

two ADC

- The ADC circuits are relatively large and have a hierarchy.
- All circuits contain symmetry group constraints.   





#### model

MAGICAL ä¼šä¸ºæ¯ä¸ª PMOS å™¨ä»¶ç”Ÿæˆå•ç‹¬çš„ NWELL æ¥è§¦å­”



##### CONSTRAINT EXTRACTION  

###### Graph Abstraction  

netlist -> graph

`Devices`, `pins`, and `nets` are all represented as nodes. 

###### Seed Pattern Detection  

![image-20251020141026483](assets/image-20251020141026483.png)

![image-20251020141322835](assets/image-20251020141322835.png)

æ¨¡å¼åŒ¹é…



###### Signal Flow Based Graph Traversal  

![image-20251020141311332](assets/image-20251020141311332.png)

define `current directions` 

###### Constraints Post-processing  

![image-20251020141401206](assets/image-20251020141401206.png)

![image-20251020141136642](assets/image-20251020141136642.png)



##### placer

- IO:
  - The inputs to the placer include the circuit netlist, extracted constraints, generated devices, and process technologydependent design rules  
  - The outputs are the legalized GDSII layout of the placement result and pin information for routing.
- satisfying the symmetry constraints and design rules. 
- åŸºäº [ISPD19, XU](), NLP
  - NLP
    - we can get a global placement result encouraging symmetry and boundary constraints with short wirelength and small device overlapping
  - legalization  and detailed placement
    - constructing the constraint graphs  
      - `constraint graphs and plane sweep algorithm`: J. Doenhardt and T. Lengauer, â€œAlgorithmic aspects of one-dimensional layout compaction,â€  IEEE TCAD, vol. 6, no. 5, pp. 863â€“878, 1987
      - missing positional constraint edges: [ISPD19, XU]()
    - linear programming (LP)
      - optimize the wirelength for the given legal placement  
- `Post-Placement Optimization`ï¼šWellGAN 

##### router

- two stages, global and detailed routing  
  - ![image-20251020152730277](assets/image-20251020152730277.png)
  - global routing: grid-based A* search routing engine, 3D grid, two-pin nets, RRR
  - detailed routing: a sequential A* search kernel is applied  
- net constraintion
- 

#### Install

To clone the repository and submodules, go to the path to download the repository.

```
# clone the repository 
git clone https://github.com/magical-eda/MAGICAL.git
git submodule init
git submodule update
```

You can use the Docker container to avoid building all the dependencies yourself.

1. Install Docker on [Linux](https://docs.docker.com/install/).

2. Navigate to the repository.

   ```
   cd MAGICAL
   ```

   

3. Get the docker container with either of the following options.

   - Option 1 (Recommended): pull from the cloud [jayl940712/magical](https://hub.docker.com/r/jayl940712/magical).

   ```
   docker pull jayl940712/magical:latest
   ```

   

   - Option 2: build the container.

   ```
   docker build . --file Dockerfile --tag magical:latest
   ```

   

4. Run the docker container

   ```
   docker run -it -v $(pwd):/MAGICAL jayl940712/magical:latest bash
   ```

   

   Or if you used option 2 to build the container

   ```
   docker run -it -v $(pwd):/MAGICAL magical:latest bash
   ```

   



### ALIGN

- [ALIGN-analoglayout/ALIGN-public](https://github.com/ALIGN-analoglayout/ALIGN-public?tab=readme-ov-file)

- [ALIGN: Document](https://align-analoglayout.github.io/ALIGN-public/index.html), MAGICAL æ²¡æœ‰æ–‡æ¡£

- The goal of ALIGN (Analog Layout, Intelligently Generated from Netlists) is to automatically translate an unannotated (or partially annotated) `SPICE netlist` of an analog circuit to a `GDSII layout`.

- also releases a set of analog circuit designs.

- covering four broad classes of functionality  

  ![image-20251022153130808](assets/image-20251022153130808.png)

- 



#### Core concept

hierarchical

![image-20251022183329802](assets/image-20251022183329802.png)



#### flow

[ALIGN: flow â€” ALIGN](https://align-analoglayout.github.io/ALIGN-public/notes/flow.html#inputs)

![image-20251022161205946](assets/image-20251022161205946.png)

- netlist

  - "Only one .sp file allowed"

  - `primitive_lib = generate_hierarchy(netlist, subckt, topology_dir, flatten, pdk_dir)`

    - align/config

      ![image-20251028171031368](assets/image-20251028171031368.png)

      - "basic_template.sp"ï¼š template library
    
        ![image-20251028173228465](assets/image-20251028173228465.png)
    
      - "user_template.sp"
    
    - `read_lib` è·å– template(PCell)
    
  - `primitives = generate_primitives(primitive_lib, pdk_dir, primitive_dir, netlist_dir, blackbox_dir, scale)`
  
    - ä¸€ä¸ªprimitiveçš„dictå†…å®¹ï¼š
  
      ![image-20251029104422761](assets/image-20251029104422761.png)
  
  - `generate_pnr`



##### Netlist auto-annotation  

   ![image-20251022161143098](assets/image-20251022161143098.png)

   The input to ALIGN is a SPICE netlist that is converted to a `graph` representation

   uses two approaches   

   - ML-based methods

     Details of the approach are provided in [GANA]()

   - Graph-traversal-based methods  

     for blocks that lie ==outside the scope of the GCN training set==, we use graph-based approaches to recognize repeated structures within a circuit.

     `approximate subgraph isomorphism`  

   å¯ä»¥æ‰¾åˆ° primitives/hierarchy/symmetry

   example:

   ![image-20251022170056167](assets/image-20251022170056167.png)

   >It is important to note that the best layout hierarchy may sometimes differ from a logical netlist hierarchy

##### Design rule capture

   ![image-20251022161522067](assets/image-20251022161522067.png)

   ![image-20251022170951260](assets/image-20251022170951260.png)



 ##### Constraint generation   

   ![image-20251022161600188](assets/image-20251022161600188.png)

two type of constraints:

1. Geometric constraints,

   symmetry, matching, and common-centroid constraints

   [GCN-based method]()

2. Electrical constraints  

   bound the maximum parasitics at any node of the circuit

   ![image-20251022173638181](assets/image-20251022173638181.png)

   ![image-20251022173715045](assets/image-20251022173715045.png)

   

##### Parameterized primitive layout generation    

   ![image-20251022162636097](assets/image-20251022162636097.png)

provides the user with a predefined `library` of parameterizable primitives

![image-20251023162826060](assets/image-20251023162826060.png)

![image-20251023083853426](assets/image-20251023083853426.png)

##### Hierarchical block assembly   

   ![image-20251022162530398](assets/image-20251022162530398.png)

placement

- SA+sequence pairs  [TCAD11]

router

- can employ one of the two detailed routers
  - `integer linear programming` formulation and an `A* algorithm`;  this works particularly well for more ==sparse designs==
  - A `satisfiability-based` [detailed router](github.com/ALIGN-analoglayout/AnalogDetailedRouter), released by Intel, is well suited for ==congested== designs



#### constraintion

[Constraints â€” ALIGN](https://align-analoglayout.github.io/ALIGN-public/notes/const.html)

- SymmetricBlocks

- Order

- align

- Enclose

- Spread

- aspect ratio

  Define ==lower and upper bounds== on aspect ratio (=width/height) of a ==subcircuit==

- Boundary

- CompactPlacementï¼Ÿ

- SameTemplateï¼Ÿ

- CreateAliasï¼Ÿ

- GroupBlocks

  Forces a ==hierarchy== creation for group of instances. This brings the instances ==closer==. This reduces the problem statement for placer thus providing better solutions.

  ![image-20251031134346066](assets/image-20251031134346066.png)

  <img src="assets/image-20251031134359494.png" alt="image-20251031134359494" style="zoom: 75%;" />

  

- DoNotIdentify

- BlockDistance

- guard ring

- GroupCaps

- NetConst

- PortLocation

- SymmetricNets

- MultiConnection

- PowerPorts

- GroundPorts

- ClockPorts

- DoNotUseLib

- ![image-20251023160914344](assets/image-20251023160914344.png)

#### PDK abstraction

- [Doc](..\Analog\Tools\ALIGN_PDK_Abstraction_Guide.pptx)

- [PDK abstraction â€” Detailed explanation](https://align-analoglayout.github.io/ALIGN-public/notes/adding_pdk.html)

- ![image-20251027161905244](assets/image-20251027161905244.png)

- Files:

  <img src="assets/image-20251027162219298.png" alt="image-20251027162219298" style="zoom: 70%;" />

##### layer.json

- [What is Front End(FEOL), Middle End, and Back End of Line(BEOL)](https://techovedas.com/what-is-front-endfeol-middle-end-and-back-end-of-linebeol-in-semiconductor-manufacturing/)
- Metal names in the â€˜layers.jsonâ€™ must start with â€˜Mâ€™ 
- Via names in the â€˜layers.jsonâ€™ must start with â€˜Vâ€™
- Do not use FEOL layer names starting with â€˜Mâ€™ or â€˜Vâ€™
- All dimensions are in nanometer
- [PDK abstraction â€” Detailed explanation](https://align-analoglayout.github.io/ALIGN-public/notes/adding_pdk.html) ä¸­æœ‰ json å­—æ®µçš„è¯¦ç»†è§£é‡Š
  - Metal/Via
  - Poly
  - Fin
  - N/Pwell
  - vt_type(RVT/LVT/HVT/SLVT)
  - active
  - Boundary Layers
  - MOM Cap

**BEOL(Back End of Line) Design rules**

![image-20251023161838750](assets/image-20251023161838750.png)

**FEOL (Front End of Line) Design rules**

These layers are used by the `cell generator` and may vary based on the `PDK`.

> ä¸€äº›å…³äºè¡¬åº•çš„ï¼Œæ¯”å¦‚ PC å±‚



##### model.sp

- Define ==models for devices available in a pdk==

- The model names are used in â€˜annotation phaseâ€™

- example

  <img src="assets/image-20251027162938213.png" alt="image-20251027162938213" style="zoom: 60%;" />

- 



#### PCell Generator

![image-20251023163213457](assets/image-20251023163213457.png)

 four basic cell types:

- [Transistor](https://github.com/ALIGN-analoglayout/ALIGN-public/blob/master/pdks/FinFET14nm_Mock_PDK/Align_primitives.py)
- [Capacitor](https://github.com/ALIGN-analoglayout/ALIGN-public/blob/master/pdks/FinFET14nm_Mock_PDK/fabric_Cap.py)
- [Resistor](https://github.com/ALIGN-analoglayout/ALIGN-public/blob/master/pdks/FinFET14nm_Mock_PDK/fabric_Res.py).
- [Guard ring](https://github.com/ALIGN-analoglayout/ALIGN-public/blob/master/pdks/FinFET14nm_Mock_PDK/fabric_ring.py).

Cell fabric module defines the common structure for cell generation utilities which are used in the primitive generator. This remains common across PDKs.



#### Hierarchical Analog Placer and Router Flow

[ALIGN-public/PlaceRouteHierFlow/README.md at master Â· ALIGN-analoglayout/ALIGN-public](https://github.com/ALIGN-analoglayout/ALIGN-public/blob/master/PlaceRouteHierFlow/README.md)



#### install

> [!CAUTION]
>
> 1. CMake ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ï¼Œå®æµ‹ `cmake4.1` ä¸è¡Œã€‚`cmake3.29.3` å¯ä»¥ä½†æ˜¯ä¹Ÿæœ‰è­¦å‘Šã€‚
>
> 2. ä¸ºäº†é˜²æ­¢ github åœ¨çº¿ä¸‹è½½é—®é¢˜ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½ä¸€ä»½ `https://github.com/ArthurSonzogni/nlohmann_json_cmake_fetchcontent/archive/refs/tags/v3.7.3.tar.gz` å’Œ `https://sourceforge.net/projects/lpsolve/files/lpsolve/5.5.2.11/lp_solve_5.5.2.11_source.tar.gz/download`
>
>    è§£å‹ç„¶åæŒ‡å®š CMAKE_ARGS åˆ°å¯¹åº”è·¯å¾„
>

> å­¦æ ¡æœåŠ¡å™¨ g++ç‰ˆæœ¬å¤ªä½ï¼Œéœ€è¦è‡ªå·±ä¸‹
>
> ` conda install -y -c conda-forge gcc_linux-64=10 gxx_linux-64=10 cmake=3.29.3 make gdb`
>
> 

```bash
conda create -y -n align python=3.10

conda activate align
conda install -c conda-forge -y boost lpsolve55
conda run python -m pip install --upgrade pip
source install_deps.sh
conda list
pip uninstall cmake
pip install cmake==3.29.3
# ä¸ºäº†é˜²æ­¢githubåœ¨çº¿ä¸‹è½½é—®é¢˜ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½ä¸€ä»½`https://github.com/ArthurSonzogni/nlohmann_json_cmake_fetchcontent/archive/refs/tags/v3.7.3.tar.gz` å’Œ `https://sourceforge.net/projects/lpsolve/files/lpsolve/5.5.2.11/lp_solve_5.5.2.11_source.tar.gz/download`
export FETCHCONTENT_SOURCE_DIR_JSON=${HOME}/Downloads/nlohmann_json_cmake_fetchcontent-3.7.3
export FETCHCONTENT_SOURCE_DIR_LPSOLVE=${HOME}/Downloads/lp_solve_5.5
# export FETCHCONTENT_FULLY_DISCONNECTED=ON      # å¯ä¿æŒï¼Œé˜²æ­¢å†æ¬¡è®¿é—®å¤–ç½‘
export CMAKE_ARGS="-DFETCHCONTENT_SOURCE_DIR_JSON=${HOME}/Downloads/nlohmann_json_cmake_fetchcontent-3.7.3 \
                   -DFETCHCONTENT_SOURCE_DIR_LPSOLVE=${HOME}/Downloads/lp_solve_5.5"
BUILD_TYPE='RelWithDebInfo' BUILD_TESTING='ON' python setup.py develop -v
```




```
(align) pengxuan@user-Super-Server:~/Software/ALIGN-public$ conda list
# packages in environment at /home/pengxuan/Software/miniconda3/envs/align:
#
# Name                     Version          Build                 Channel
_libgcc_mutex              0.1              main
_openmp_mutex              5.1              1_gnu
align                      0.9.8            pypi_0                pypi
blinker                    1.9.0            pypi_0                pypi
boost                      1.78.0           py310hc4a4660_0       conda-forge
boost-cpp                  1.78.0           h75c5d50_1            conda-forge
bzip2                      1.0.8            h5eee18b_6
ca-certificates            2025.10.5        hbd8a1cb_0            conda-forge
certifi                    2025.10.5        pypi_0                pypi
cffi                       1.15.1           pypi_0                pypi
charset-normalizer         3.4.4            pypi_0                pypi
click                      8.3.0            pypi_0                pypi
cmake                      3.29.3           pypi_0                pypi
colorlog                   6.10.1           pypi_0                pypi
coverage                   7.11.0           pypi_0                pypi
dash                       3.2.0            pypi_0                pypi
distro                     1.9.0            pypi_0                pypi
exceptiongroup             1.3.0            pypi_0                pypi
execnet                    2.1.1            pypi_0                pypi
expat                      2.7.1            h6a678d5_0
flask                      3.1.2            pypi_0                pypi
flatdict                   4.0.1            pypi_0                pypi
gdspy                      1.6.13           pypi_0                pypi
icu                        70.1             h27087fc_0            conda-forge
idna                       3.11             pypi_0                pypi
importlib-metadata         8.7.0            pypi_0                pypi
iniconfig                  2.3.0            pypi_0                pypi
itsdangerous               2.2.0            pypi_0                pypi
jinja2                     3.1.6            pypi_0                pypi
ld_impl_linux-64           2.44             h153f514_2
libblas                    3.9.0            37_h4a7cf45_openblas  conda-forge
libcblas                   3.9.0            37_h0358290_openblas  conda-forge
libffi                     3.4.4            h6a678d5_1
libgcc-ng                  11.2.0           h1234567_1
libgfortran-ng             13.2.0           h69a702a_0            conda-forge
libgfortran5               13.2.0           ha4646dd_0            conda-forge
libgomp                    11.2.0           h1234567_1
liblapack                  3.9.0            37_h47877c9_openblas  conda-forge
libnsl                     2.0.0            h5eee18b_0
libopenblas                0.3.30           h46f56fc_0
libstdcxx-ng               11.2.0           h1234567_1
libuuid                    1.41.5           h5eee18b_0
libxcb                     1.17.0           h9b100fa_0
libzlib                    1.3.1            hb25bd0a_0
lp_solve                   5.5.2.5          h14c3975_1001         conda-forge
lpsolve55                  5.5              py310h96516ba_1004    conda-forge
lz4-c                      1.9.3            h9c3ff4c_1            conda-forge
markupsafe                 3.0.3            pypi_0                pypi
memory-profiler            0.61.0           pypi_0                pypi
mip                        1.15.0           pypi_0                pypi
more-itertools             10.8.0           pypi_0                pypi
narwhals                   2.9.0            pypi_0                pypi
ncurses                    6.5              h7934f7d_0
nest-asyncio               1.6.0            pypi_0                pypi
networkx                   3.4.2            pypi_0                pypi
ninja                      1.13.0           pypi_0                pypi
numpy                      2.2.6            pypi_0                pypi
openssl                    3.0.18           hd6dcaed_0
packaging                  25.0             pypi_0                pypi
pandas                     2.3.3            pypi_0                pypi
pip                        25.3             pypi_0                pypi
plotly                     6.3.1            pypi_0                pypi
pluggy                     1.6.0            pypi_0                pypi
psutil                     7.1.2            pypi_0                pypi
pthread-stubs              0.3              h0ce48e5_1
pybind11                   3.0.1            pypi_0                pypi
pycparser                  2.23             pypi_0                pypi
pydantic                   1.10.24          pypi_0                pypi
pygments                   2.19.2           pypi_0                pypi
pytest                     8.4.2            pypi_0                pypi
pytest-cov                 7.0.0            pypi_0                pypi
pytest-cpp                 2.6.0            pypi_0                pypi
pytest-rerunfailures       16.1             pypi_0                pypi
pytest-timeout             2.4.0            pypi_0                pypi
pytest-xdist               3.8.0            pypi_0                pypi
python                     3.10.19          h6fa692b_0
python-dateutil            2.9.0.post0      pypi_0                pypi
python-gdsii               0.2.1            pypi_0                pypi
python_abi                 3.10             2_cp310               conda-forge
pytz                       2025.2           pypi_0                pypi
pyyaml                     6.0.3            pypi_0                pypi
readline                   8.3              hc2a1206_0
requests                   2.32.5           pypi_0                pypi
retrying                   1.4.2            pypi_0                pypi
scikit-build               0.18.1           pypi_0                pypi
setuptools                 80.9.0           py310h06a4308_0
six                        1.17.0           pypi_0                pypi
sqlite                     3.50.2           hb25bd0a_1
tk                         8.6.15           h54e0aa7_0
tomli                      2.3.0            pypi_0                pypi
typing-extensions          4.15.0           pypi_0                pypi
tzdata                     2025.2           pypi_0                pypi
urllib3                    2.5.0            pypi_0                pypi
werkzeug                   3.1.3            pypi_0                pypi
wheel                      0.45.1           py310h06a4308_0
xorg-libx11                1.8.12           h9b100fa_1
xorg-libxau                1.0.12           h9b100fa_0
xorg-libxdmcp              1.1.5            h9b100fa_0
xorg-xorgproto             2024.1           h5eee18b_1
xz                         5.6.4            h5eee18b_1
z3-solver                  4.15.3.0         pypi_0                pypi
zipp                       3.23.0           pypi_0                pypi
zlib                       1.3.1            hb25bd0a_0
zstd                       1.5.2            h8a70e8d_1            conda-forge
```



##### bug

GLIBCXX_3.4.30' not found

```bash
Traceback (most recent call last):
  File "/home/pengxuan/Software/miniconda3/envs/align/bin/schematic2layout.py", line 2, in <module>
    import align
  File "/home/pengxuan/Software/ALIGN-public/align/__init__.py", line 6, in <module>
    from .main import schematic2layout
  File "/home/pengxuan/Software/ALIGN-public/align/main.py", line 14, in <module>
    from .pnr import generate_pnr
  File "/home/pengxuan/Software/ALIGN-public/align/pnr/__init__.py", line 1, in <module>
    from .checkers import *
  File "/home/pengxuan/Software/ALIGN-public/align/pnr/checkers.py", line 7, in <module>
    from .router import NType
  File "/home/pengxuan/Software/ALIGN-public/align/pnr/router.py", line 12, in <module>
    from .. import PnR
ImportError: /home/pengxuan/Software/miniconda3/envs/align/bin/../lib/libstdc++.so.6: version `GLIBCXX_3.4.30' not found (required by /home/pengxuan/Software/ALIGN-public/align/PnR.cpython-310-x86_64-linux-gnu.so)

```

> fix: `conda install -c conda-forge "libstdcxx-ng>=13.2.0"`



#### debug

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Debug schematic2layout",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/bin/schematic2layout.py",
            "args": [
                "${workspaceFolder}/examples/telescopic_ota",
                "-p",
                "${workspaceFolder}/pdks/FinFET14nm_Mock_PDK/"
            ],
            "cwd": "${workspaceFolder}/work",
            "console": "integratedTerminal",
            "justMyCode": false
        }
    ]
}
```





## viewer

### KLayout

[KLayout Layout Viewer And Editor](https://www.klayout.de/doc-qt5/manual/basic.html)

#### install

>  æ—  sudo æƒé™ local ä¸‹è½½

```bash
  535  rm -rf ../local/
  536  mkdir -p ~/local/klayout && cd ~/local/klayout
  537  dpkg-deb -x ~/Downloads/klayout_0.30.4-1_amd64.deb .
  538  ls
  539  source ~/.bashrc
  540  klayout -v
  541  find ~/local/klayout -name 'libklayout_tl.so*'
  542  find ~/local/klayout -name 'x86_64-linux-gnu'
  543  source ~/.bashrc
  544  klayout -v
  545  export LD_LIBRARY_PATH="$HOME/local/klayout/usr/lib/klayout:$HOME/local/klayout/usr/lib:$LD_LIBRARY_PATH"
  546  klayout -v
  547  tree usr/
  548  apt download libgit2-28
  549  ls
  550  find "libgit2*"
  551  find -name "libgit2*"
  552  dpkg-deb -x libgit2-28_*.deb ~/local/klayout
  553  find -name "libgit2*"
  554  export LD_LIBRARY_PATH="$HOME/local/klayout/usr/lib/x86_64-linux-gnu:$HOME/local/klayout/usr/lib/klayout:$HOME/local/klayout/usr/lib:$LD_LIBRARY_PATH"
  555  klayout -v
  556  find libQt5Xml.so.5
  557  apt download libqt5xml5
  558  dpkg-deb -x libqt5xml5_*_amd64.deb ~/local/klayout
  559  tree .
  560  export LD_LIBRARY_PATH="$HOME/local/klayout/usr/lib/x86_64-linux-gnu:$HOME/local/klayout/usr/lib/klayout:$HOME/local/klayout/usr/lib:$LD_LIBRARY_PATH"
  561  export QT_PLUGIN_PATH="$HOME/local/klayout/usr/lib/qt5/plugins:$QT_PLUGIN_PATH"
  562  ldd ~/local/klayout/usr/bin/klayout | grep "not found"
  563  klayout -v
  564  cd ~/Downloads
  565  apt download libqt5printsupport5 libqt5sql5 libqt5designer5 libqt5multimediawidgets5 libqt5multimedia5 libqt5xmlpatterns5 libmbedcrypto3 libmbedtls12 libmbedx509-0 libhttp-parser2.9 libssh2-1
  566  for pkg in libqt5printsupport5_* libqt5sql5_* libqt5designer5_* libqt5multimediawidgets5_* libqt5multimedia5_* libqt5xmlpatterns5_* libmbedcrypto3_* libmbedtls12_* libmbedx509-0_* libhttp-parser2.9_* libssh2-1_*; do     dpkg-deb -x "$pkg" ~/local/klayout; done
  567  export LD_LIBRARY_PATH="$HOME/local/klayout/usr/lib/x86_64-linux-gnu:$HOME/local/klayout/usr/lib/klayout:$HOME/local/klayout/usr/lib:$LD_LIBRARY_PATH"
  568  export QT_PLUGIN_PATH="$HOME/local/klayout/usr/lib/qt5/plugins:$QT_PLUGIN_PATH"
  569  ldd ~/local/klayout/usr/bin/klayout | grep "not found"
  570  cd ~/Downloads
  571  apt download libqt5opengl5
  572  dpkg-deb -x libqt5opengl5_*_amd64.deb ~/local/klayout
  573  source ~/.bashrc
  574  ldd ~/local/klayout/usr/bin/klayout | grep "not found"
  575  klayout -v
```

